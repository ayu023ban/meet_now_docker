{"version":3,"sources":["views/View.js"],"names":["useStyles","makeStyles","theme","container","background","palette","default","height","width","position","color","text","primary","paper","display","alignItems","justifyContent","maxWidth","marginLeft","marginRight","top","View","roomID","useParams","history","useHistory","classes","myID","useSelector","state","userReducer","user","pk","useState","acceptStatus","setAcceptStatus","serverMessage","setServerMessage","useEffect","WebSocketInstance","refresh","protocol","window","location","host","hostname","includes","connect","e","replace","message","type","on","getPermissionListener","close","className","elevation","variant","style","align"],"mappings":"mOAUMA,EAAYC,aAAW,SAACC,GAAD,MAAY,CACvCC,UAAW,CACTC,WAAYF,EAAMG,QAAQD,WAAWE,QACrCC,OAAQ,OACRC,MAAO,OACPC,SAAU,YAEZC,MAAO,CAAEA,MAAOR,EAAMG,QAAQM,KAAKC,SACnCC,MAAO,CACLC,QAAS,OACTC,WAAY,SACZC,eAAgB,SAChBC,SAAU,OACVR,SAAU,WACVS,WAAY,OACZC,YAAa,OACbC,IAAK,YAwFMC,UApFF,WAAO,IACVC,EAAWC,cAAXD,OACFE,EAAUC,cACVC,EAAU1B,IACV2B,EAAOC,aAAY,SAACC,GAAD,OAAWA,EAAMC,YAAYC,KAAKC,MAJ1C,EAKuBC,mBAAS,WALhC,mBAKVC,EALU,KAKIC,EALJ,OAMyBF,mBAAS,IANlC,mBAMVG,EANU,KAMKC,EANL,KA8CjB,OAvCAC,qBAAU,WACRC,IAAkBC,UAClB,IAAIC,EAAwC,UAA7BC,OAAOC,SAASF,SAAuB,KAAO,MACzDG,EAAOF,OAAOC,SAASE,SAASC,SAAS,aACzC,iBACAJ,OAAOC,SAASE,SAoBpB,OAnBAN,IAAkBQ,QAAlB,UACKN,EADL,cACmBG,EADnB,oBACmCtB,EADnC,MAEE,SAAC0B,GACCxB,EAAQyB,QAAQ,IAAK,CACnBC,QAAS,gCACTC,KAAM,aAIZZ,IAAkBa,GAChB,iBACAC,YAAsB1B,EAAMQ,IAE9BI,IAAkBa,GAAG,gBAAgB,SAACF,GACpB,0BAAZA,GAAqCf,EAAgB,WACzDE,EACE,kFAGG,WACLE,IAAkBe,WAEnB,IAEHhB,qBAAU,WACa,WAAjBJ,GACFV,EAAQyB,QAAQ,IAAK,CACnBC,QAAS,wCACTC,KAAM,YAGT,CAACjB,IAGF,mCACoB,YAAjBA,EACC,qBAAKqB,UAAW7B,EAAQvB,UAAxB,SACE,eAAC,IAAD,CAAOqD,UAAW,EAAGC,QAAQ,WAAWF,UAAW7B,EAAQb,MAA3D,UACE,cAAC,IAAD,CACE4C,QAAQ,KACRF,UAAW7B,EAAQhB,MACnBgD,MAAO,CAAElD,MAAO,eAHlB,8BAOA,cAAC,IAAD,CACE+C,UAAW7B,EAAQhB,MACnBgD,MAAO,CAAExC,WAAY,eAIR,WAAjBgB,EACF,cAAC,UAAD,IACmB,YAAjBA,EACF,qBAAKqB,UAAW7B,EAAQvB,UAAxB,SACE,cAAC,IAAD,CAAOqD,UAAW,EAAGC,QAAQ,WAAWF,UAAW7B,EAAQb,MAA3D,SACE,cAAC,IAAD,CACE4C,QAAQ,KACRF,UAAW7B,EAAQhB,MACnBgD,MAAO,CAAElD,MAAO,eAChBmD,MAAM,SAJR,SAMGvB,QAIL","file":"static/js/10.b55627ef.chunk.js","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport WebSocketInstance from \"../components/WebsocketService\";\nimport { useHistory, useParams } from \"react-router\";\nimport Room from \"./RoomView\";\nimport { getPermissionListener } from \"../helper/socketListeners\";\nimport { useSelector } from \"react-redux\";\nimport Typography from \"@material-ui/core/Typography\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport { makeStyles } from \"@material-ui/styles\";\nimport { Paper } from \"@material-ui/core\";\nconst useStyles = makeStyles((theme) => ({\n  container: {\n    background: theme.palette.background.default,\n    height: \"100%\",\n    width: \"100%\",\n    position: \"relative\",\n  },\n  color: { color: theme.palette.text.primary },\n  paper: {\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    maxWidth: \"75vw\",\n    position: \"relative\",\n    marginLeft: \"auto\",\n    marginRight: \"auto\",\n    top: \"3rem\",\n  },\n}));\n\nconst View = () => {\n  const { roomID } = useParams();\n  const history = useHistory();\n  const classes = useStyles();\n  const myID = useSelector((state) => state.userReducer.user.pk);\n  const [acceptStatus, setAcceptStatus] = useState(\"pending\");\n  const [serverMessage, setServerMessage] = useState(\"\");\n  useEffect(() => {\n    WebSocketInstance.refresh();\n    let protocol = window.location.protocol === \"http:\" ? \"ws\" : \"wss\";\n    let host = window.location.hostname.includes(\"localhost\")\n      ? \"localhost:7000\"\n      : window.location.hostname;\n    WebSocketInstance.connect(\n      `${protocol}://${host}/ws/room/${roomID}/`,\n      (e) => {\n        history.replace(\"/\", {\n          message: \"the url entered is incorrect.\",\n          type: \"error\",\n        });\n      }\n    );\n    WebSocketInstance.on(\n      \"get permission\",\n      getPermissionListener(myID, setAcceptStatus)\n    );\n    WebSocketInstance.on(\"join message\", (message) => {\n      if (message === \"creator not available\") setAcceptStatus(\"message\");\n      setServerMessage(\n        \"The creator has not joined the room yet. Please try joining after some time\"\n      );\n    });\n    return () => {\n      WebSocketInstance.close();\n    };\n  }, []);\n\n  useEffect(() => {\n    if (acceptStatus === \"reject\") {\n      history.replace(\"/\", {\n        message: \"The creator rejected the join request\",\n        type: \"error\",\n      });\n    }\n  }, [acceptStatus]);\n\n  return (\n    <>\n      {acceptStatus === \"pending\" ? (\n        <div className={classes.container}>\n          <Paper elevation={3} variant=\"outlined\" className={classes.paper}>\n            <Typography\n              variant=\"h2\"\n              className={classes.color}\n              style={{ width: \"max-content\" }}\n            >\n              Joining the room\n            </Typography>\n            <CircularProgress\n              className={classes.color}\n              style={{ marginLeft: \"1rem\" }}\n            />\n          </Paper>\n        </div>\n      ) : acceptStatus === \"accept\" ? (\n        <Room />\n      ) : acceptStatus === \"message\" ? (\n        <div className={classes.container}>\n          <Paper elevation={3} variant=\"outlined\" className={classes.paper}>\n            <Typography\n              variant=\"h2\"\n              className={classes.color}\n              style={{ width: \"max-content\" }}\n              align=\"center\"\n            >\n              {serverMessage}\n            </Typography>\n          </Paper>\n        </div>\n      ) : null}\n    </>\n  );\n};\n\nexport default View;\n"],"sourceRoot":""}