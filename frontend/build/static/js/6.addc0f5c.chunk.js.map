{"version":3,"sources":["redux/actions/roomActions.js","helper/WebsocketService.js","components/common/Video.js","components/Room/DetailModal.js","components/Room/InviteModal.js","components/Room/Controls.js","helper/utilFunctions.js","components/Room/Chat.js","helper/socketListeners.js","helper/peers.js","components/Room/JoinModal.js","helper/unusedFunctions.js","views/RoomView.js","views/View.js"],"names":["createNewRoom","data","url","create_room","dispatch","apiClient","post","then","res","apiDispatch","CREATE_ROOM","navigator","clipboard","writeText","getUrlFromCode","id","toast","success","catch","err","error","getRooms","get_room","get","GET_ROOMS","deleteRoom","roomID","fallback","getState","delete","getRoom","GET_ROOM","toggleAudio","TOGGLE_USER_AUDIO","toggleVideo","TOGGLE_USER_VIDEO","inviteUser","roomId","invite","response","removeInviteUser","removeInvite","getInvitations","getIsUserCreator","isUserCreator","SET_USER_IS_CREATOR","isCreator","WebSocketService","callbacks","this","socketRef","forcedClose","chatroom_url","WebSocket","onopen","console","log","onmessage","e","socketNewMessage","onerror","debug","onclose","code","setTimeout","connect","reason","close","command","func","received_data","parsedData","JSON","parse","Object","keys","length","type","waitForConnection","send","stringify","bind","message","readyState","callback","interval","state","that","instance","WebSocketInstance","getInstance","useStyles","makeStyles","theme","responsive","size","rows","float","width","height","display","alignItems","videoTop","paddingTop","position","overflow","background","palette","paper","margin","borderRadius","micOff","right","top","videoOff","left","justifyContent","avatar","fontSize","hoverDiv","remove","color","Video","React","forwardRef","ref","peer","muted","isUserVideo","user","localRef","useRef","currentRef","classes","useState","open","setOpen","useSelector","roomReducer","invitedUsers","currentRoom","invited_users","initials","first_name","toUpperCase","last_name","useEffect","on","stream","current","srcObject","className","style","objectFit","transform","videoOn","playsInline","autoPlay","onClick","onMouseEnter","Fade","in","onMouseLeave","opacity","Tooltip","title","IconButton","sendMessage","userID","some","el","audioOn","Avatar","DetailModal","roomName","room_name","Dialog","onClose","o","aria-labelledby","aria-describedby","DialogTitle","DialogContent","Typography","variant","DialogContentText","window","location","href","DialogActions","text","onCopy","Button","InviteModal","useParams","str","err_message","email","setEmail","useDispatch","map","idx","Row","Col","invitee","TextField","value","onChange","target","helperText","validateEmailAddress","container","minHeight","flexGrow","default","blue","orange","red","marginRight","Controls","switchc","toggleChat","isAudioOn","userVideo","isVideoOn","detailModalOpen","setDetailModalOpen","inviteModalOpen","setInviteModalOpen","history","useHistory","useTheme","isMobile","useMediaQuery","breakpoints","down","anchorEl","setAnchorEl","isMenuOpen","Boolean","Paper","elevation","Grid","justify","marginLeft","replace","aria-controls","aria-haspopup","event","currentTarget","Menu","keepMounted","MenuItem","split","x","n","Math","floor","sqrt","zp","pp","m","i","push","reverse","count","getFullName","firstName","lastName","trim","drawer","flexShrink","drawerPaper","drawerHeader","padding","spacing","mixins","toolbar","chatInputContainer","marginTop","chatInput","marginBottom","borderBottom","paddingBottom","messageBoxRight","primary","messageBoxLeft","messageSender","MessageItem","props","owner","userReducer","messagePosition","pk","sender","messageBackground","MessageList","memo","messages","slice","messageItem","senderAvatar","Chat","setMessages","currMessage","setCurrMessage","onCurrMessageChanged","useCallback","val","Drawer","anchor","placeholder","fullWidth","multiline","rowsMax","InputProps","endAdornment","InputAdornment","aria-label","all_users_listener","peersRef","myID","setPeers","users","temp","forEach","userToSignal","callerID","Peer","initiator","trickle","signal","WebsocketService","createPeer","user_joined_listener","isUserAudioOn","isUserVideoOn","payload","callerUser","usable_id","incomingSignal","addPeer","peers","info","modal","JoinModal","waitingUsers","setWaitingUsers","Modal","show","onHide","backdrop","keyboard","Header","Title","Body","status","filter","rejectUser","acceptUser","Footer","updateStream","userStream","key","streams","getTracks","track","stop","removeTrack","getVideoTracks","addTrack","videoConstraints","innerHeight","innerWidth","flexDirection","socketFunctions","receive_returned_signal","destroy","user_left_listener","videoMediaListener","audioMediaListener","getUniqueArray","getPermissionRequestListener","Room","setUserStream","currentCameraRef","sizeMap","chatOpen","setChatOpen","me","setCameraStream","a","mediaDevices","getUserMedia","video","audio","socketConnect","userStreamRef","getAudioTracks","enabled","maxHeight","flexWrap","values","item","index","enumerateDevices","devices","videoDevices","device","kind","updatedConstraints","deviceId","exact","maxWidth","View","acceptStatus","setAcceptStatus","serverMessage","setServerMessage","refresh","protocol","host","hostname","includes","getPermissionListener","joinMessageListener","userKickedListener","userBlockedListener","CircularProgress","align"],"mappings":"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","file":"static/js/6.addc0f5c.chunk.js","sourcesContent":["import apiClient from \"../../helper/apiclient\";\nimport { toast } from \"react-toastify\";\n\nimport {\n  CREATE_ROOM,\n  GET_ROOM,\n  GET_ROOMS,\n  SET_USER_IS_CREATOR,\n  TOGGLE_USER_AUDIO,\n  TOGGLE_USER_VIDEO,\n} from \"./roomActionTypes\";\n\nimport {\n  create_room,\n  get_room,\n  invite,\n  isUserCreator,\n  removeInvite,\n} from \"../../config/backend_api\";\n\nimport { apiDispatch, getUrlFromCode } from \"../../helper/helperFunctions\";\nimport { getInvitations } from \"./userActions\";\n\nexport const createNewRoom = (data) => {\n  const url = create_room;\n  return (dispatch) => {\n    apiClient\n      .post(url, data)\n      .then((res) => {\n        dispatch(apiDispatch(CREATE_ROOM, res.data));\n        navigator.clipboard.writeText(getUrlFromCode(res.data.id));\n        toast.success(\"copied to clipboard\");\n      })\n      .catch((err) => {\n        toast.error(`error occured in creating the room`);\n      });\n  };\n};\n\nexport const getRooms = () => {\n  const url = get_room;\n  return (dispatch) => {\n    apiClient\n      .get(url)\n      .then((res) => {\n        dispatch(apiDispatch(GET_ROOMS, res.data));\n      })\n      .catch((err) => {\n        toast.error(`error occured in fetching your rooms`, {});\n      });\n  };\n};\n\nexport const deleteRoom = (roomID, fallback) => {\n  const url = `${get_room}${roomID}/`;\n  return (dispatch, getState) => {\n    apiClient.delete(url).then((res) => {\n      fallback(roomID);\n    });\n  };\n};\n\nexport const getRoom = (roomID) => {\n  const url = `${get_room}${roomID}/`;\n  return (dispatch) => {\n    apiClient.get(url).then((res) => {\n      dispatch(apiDispatch(GET_ROOM, res.data));\n    });\n  };\n};\n\nexport const toggleAudio = () => {\n  return (dispatch) => {\n    dispatch(apiDispatch(TOGGLE_USER_AUDIO));\n  };\n};\nexport const toggleVideo = () => {\n  return (dispatch) => {\n    dispatch(apiDispatch(TOGGLE_USER_VIDEO));\n  };\n};\n\nexport const inviteUser = (roomId, data) => {\n  const url = invite(roomId);\n  return (dispatch) => {\n    apiClient\n      .post(url, data)\n      .then((res) => {\n        dispatch(apiDispatch(GET_ROOM, res.data));\n        toast.success(\"user invited\");\n      })\n      .catch((err) => {\n        toast.error(err.response.data);\n      });\n  };\n};\n\nexport const removeInviteUser = (roomID, data) => {\n  const url = removeInvite(roomID);\n  return (dispatch) => {\n    apiClient\n      .post(url, data)\n      .then((res) => {\n        dispatch(apiDispatch(GET_ROOM, res.data));\n        dispatch(getInvitations());\n      })\n      .catch((err) => {\n        toast.error(err.response.data);\n      });\n  };\n};\n\nexport const getIsUserCreator = (roomId) => {\n  const url = isUserCreator(roomId);\n  return (dispatch) => {\n    apiClient.get(url).then((res) => {\n      dispatch(apiDispatch(SET_USER_IS_CREATOR, res.data.isCreator));\n    });\n  };\n};\n","class WebSocketService {\n  static instance = null;\n  callbacks = {};\n\n  static getInstance() {\n    if (!WebSocketService.instance) {\n      WebSocketService.instance = new WebSocketService();\n    }\n    return WebSocketService.instance;\n  }\n\n  constructor() {\n    this.socketRef = null;\n    this.fallback = null;\n    this.forcedClose = false;\n  }\n\n  connect(chatroom_url, fallback = () => {}) {\n    this.forcedClose = false;\n    this.fallback = fallback;\n    this.socketRef = new WebSocket(chatroom_url);\n\n    this.socketRef.onopen = () => {\n      console.log(\"websocket open\");\n    };\n\n    this.socketRef.onmessage = (e) => {\n      this.socketNewMessage(e.data);\n    };\n\n    this.socketRef.onerror = (e) => {\n      console.debug(e);\n    };\n\n    this.socketRef.onclose = (e) => {\n      console.log(e);\n      if (e.code === 4000) {\n        this.fallback(e);\n      } else if (this.forcedClose) {\n        console.log(\"websocket closed\");\n      } else {\n        console.log(\"websockets closed lets reopen\");\n        setTimeout(() => {\n          this.connect(chatroom_url, fallback(e));\n        }, 5000);\n      }\n    };\n  }\n\n  close(code, reason) {\n    // Default CLOSE_NORMAL code\n    if (typeof code == \"undefined\") {\n      code = 1000;\n    }\n    this.forcedClose = true;\n    if (this.socketRef) {\n      this.socketRef.close(code, reason);\n    }\n  }\n  on(command, func) {\n    this.callbacks[command] = func;\n  }\n\n  socketNewMessage(received_data) {\n    const parsedData = JSON.parse(received_data);\n    const { command, data } = parsedData;\n    if (Object.keys(this.callbacks).length === 0) {\n      return;\n    }\n    if (this.callbacks[command]) {\n      this.callbacks[command](data);\n    }\n  }\n\n  sendMessage(type, data) {\n    try {\n      this.waitForConnection(\n        function () {\n          this.socketRef.send(JSON.stringify({ type, data }));\n        }.bind(this),\n        1000\n      );\n    } catch (err) {\n      console.log(err.message);\n    }\n  }\n  refresh() {\n    if (this.socketRef) {\n      this.socketRef.close();\n    }\n  }\n\n  state() {\n    return this.socketRef.readyState;\n  }\n  waitForConnection(callback, interval) {\n    if (this.state() === 1) {\n      callback();\n    } else {\n      var that = this;\n      // optional: implement backoff for interval here\n      setTimeout(function () {\n        that.waitForConnection(callback, interval);\n      }, interval);\n    }\n  }\n}\n\nconst WebSocketInstance = WebSocketService.getInstance();\n\nexport default WebSocketInstance;\n","import { IconButton, makeStyles, Tooltip } from \"@material-ui/core\";\nimport React, { useEffect, useRef } from \"react\";\nimport MicOffIcon from \"@material-ui/icons/MicOff\";\nimport Avatar from \"@material-ui/core/Avatar\";\nimport Fade from \"@material-ui/core/Fade\";\nimport RemoveCircleOutlineIcon from \"@material-ui/icons/RemoveCircleOutline\";\nimport WebSocketInstance from \"../../helper/WebsocketService\";\nimport { useSelector } from \"react-redux\";\nimport BlockIcon from \"@material-ui/icons/Block\";\nimport { toast } from \"react-toastify\";\n\nconst useStyles = makeStyles((theme) => ({\n  responsive: ({ size, rows }) => ({\n    float: \"left\",\n    width: `${100 / size}%`,\n    height: `${100 / rows}%`,\n    display: \"flex\",\n    alignItems: \"center\",\n  }),\n  videoTop: {\n    width: \"95%\",\n    paddingTop: \"min(calc(100vh - 9rem), 56.25%)\",\n    position: \"relative\",\n    overflow: \"hidden\",\n    background: theme.palette.background.paper,\n    margin: \"auto\",\n    borderRadius: \"1rem\",\n  },\n  micOff: {\n    position: \"absolute\",\n    right: 0,\n    top: 0,\n  },\n  videoOff: {\n    position: \"absolute\",\n    width: \"100%\",\n    height: \"100%\",\n    top: 0,\n    left: 0,\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n  },\n  avatar: {\n    width: \"min(50%, 10rem)\",\n    height: \"min(50%, 10rem)\",\n    fontSize: \"3rem\",\n  },\n  hoverDiv: {\n    position: \"absolute\",\n    top: \"0\",\n    left: \"0\",\n    width: \"100%\",\n    height: \"100%\",\n  },\n  remove: {\n    color: \"#eee8d5\",\n  },\n}));\n\nconst Video = React.forwardRef(\n  ({ peer, muted, size, rows, isUserVideo, user }, ref) => {\n    const localRef = useRef(null);\n    const currentRef = ref || localRef;\n    const classes = useStyles({ size, rows });\n    const [open, setOpen] = React.useState(false);\n    const isCreator = useSelector((state) => state.roomReducer.isUserCreator);\n    const invitedUsers = useSelector(\n      (state) => state.roomReducer.currentRoom.invited_users\n    );\n\n    let initials =\n      (user.first_name ? user.first_name[0].toUpperCase() : \"\") +\n      (user.last_name ? user.last_name[0].toUpperCase() : \"\");\n    useEffect(() => {\n      if (peer) {\n        peer.on(\"stream\", (stream) => {\n          currentRef.current.srcObject = stream;\n        });\n      }\n    }, []);\n    const removeUser = () => {\n      WebSocketInstance.sendMessage(\"user kick\", { userID: user.id });\n    };\n    const blockUser = () => {\n      if (invitedUsers.some((el) => el.id === user.id)) {\n        toast.error(\"user is invited. first remove the invitation\");\n      } else {\n        WebSocketInstance.sendMessage(\"user block\", { userID: user.id });\n      }\n    };\n    return (\n      <div className={classes.responsive}>\n        <div className={classes.videoTop}>\n          <video\n            style={{\n              objectFit: \"contain\",\n              transform: isUserVideo ? \"scaleX(-1)\" : 1,\n              position: \"absolute\",\n              top: \"0\",\n              left: \"0\",\n              display: user.videoOn ? \"block\" : \"none\",\n            }}\n            playsInline\n            width=\"100%\"\n            height=\"100%\"\n            autoPlay\n            muted={muted}\n            ref={currentRef}\n            onClick={() => {}}\n            onMouseEnter={() => {\n              setOpen(true);\n            }}\n          />\n          {isCreator && !isUserVideo && open && (\n            <Fade in={open}>\n              <div\n                className={classes.hoverDiv}\n                onMouseLeave={() => {\n                  setOpen(false);\n                }}\n              >\n                <div\n                  style={{\n                    opacity: 0.6,\n                    background: \"black\",\n                    width: \"100%\",\n                    height: \"100%\",\n                    display: \"flex\",\n                    justifyContent: \"center\",\n                    alignItems: \"center\",\n                  }}\n                >\n                  <Tooltip title=\"remove user\">\n                    <IconButton className={classes.remove} onClick={removeUser}>\n                      <RemoveCircleOutlineIcon fontSize=\"large\" />\n                    </IconButton>\n                  </Tooltip>\n                  <Tooltip title=\"Block user\">\n                    <IconButton className={classes.remove} onClick={blockUser}>\n                      <BlockIcon fontSize=\"large\" />\n                    </IconButton>\n                  </Tooltip>\n                </div>\n              </div>\n            </Fade>\n          )}\n          {!user.audioOn && (\n            <IconButton className={classes.micOff}>\n              <MicOffIcon />\n            </IconButton>\n          )}\n          {!user.videoOn && (\n            <div className={classes.videoOff}>\n              <Avatar className={classes.avatar}>{initials}</Avatar>\n            </div>\n          )}\n        </div>\n      </div>\n    );\n  }\n);\n\nexport default Video;\n","import React from \"react\";\nimport {\n  Typography,\n  Dialog,\n  DialogContent,\n  DialogContentText,\n  DialogTitle,\n  DialogActions,\n  Button,\n} from \"@material-ui/core\";\nimport { useSelector } from \"react-redux\";\nimport CopyToClipboard from \"react-copy-to-clipboard\";\nimport { toast } from \"react-toastify\";\n\nconst DetailModal = ({ open, setOpen }) => {\n  const roomName = useSelector(\n    (state) => state.roomReducer.currentRoom.room_name\n  );\n  return (\n    <Dialog\n      open={open}\n      onClose={() => {\n        setOpen((o) => !o);\n      }}\n      aria-labelledby=\"alert-dialog-title\"\n      aria-describedby=\"alert-dialog-description\"\n    >\n      <DialogTitle id=\"alert-dialog-title\">{\"Meeting Details\"}</DialogTitle>\n      <DialogContent>\n        <Typography variant=\"h5\">{roomName}</Typography>\n        <br></br>\n        <Typography variant=\"p\">{\"Joining info\"}</Typography>\n        <DialogContentText id=\"alert-dialog-description\">\n          {window.location.href}\n        </DialogContentText>\n      </DialogContent>\n      <DialogActions>\n        <CopyToClipboard\n          text={window.location.href}\n          onCopy={() => {\n            toast.success(\"copied to clipboard\");\n          }}\n        >\n          <Button>Copy link</Button>\n        </CopyToClipboard>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nexport default DetailModal;\n","import React from \"react\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogTitle,\n  IconButton,\n  TextField,\n} from \"@material-ui/core\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { Col, Row } from \"react-bootstrap\";\nimport CloseIcon from \"@material-ui/icons/Close\";\nimport { useState } from \"react\";\nimport SendIcon from \"@material-ui/icons/Send\";\nimport { validateEmailAddress } from \"../../helper/helperFunctions\";\nimport { inviteUser, removeInviteUser } from \"../../redux/actions/roomActions\";\nimport { useParams } from \"react-router\";\n\nconst InviteModal = ({ open, setOpen }) => {\n  const { roomID } = useParams();\n  const invitedUsers = useSelector(\n    (state) => state.roomReducer.currentRoom.invited_users || []\n  );\n  const [email, setEmail] = useState({\n    str: \"\",\n    err_message: \"\",\n  });\n  const dispatch = useDispatch();\n  const invite = () => {\n    const str = email.str;\n    let err_message = \"\";\n    if (str.length === 0) err_message = \"email can't be empty\";\n    else if (!validateEmailAddress(str)) err_message = \"email not valid\";\n    else {\n      dispatch(\n        inviteUser(roomID, {\n          invitee: str,\n        })\n      );\n      setEmail({ str: \"\", err_message: \"\" });\n    }\n    if (err_message.length) {\n      setEmail({ str, err_message });\n    }\n  };\n  return (\n    <Dialog\n      open={open}\n      onClose={() => {\n        setOpen((o) => !o);\n      }}\n    >\n      <DialogTitle>{\"Invite people\"}</DialogTitle>\n      <DialogContent>\n        {invitedUsers.map((user, idx) => (\n          <Row key={idx} style={{ alignItems: \"center\" }}>\n            <Col>{user.email}</Col>\n            <IconButton\n              onClick={() => {\n                dispatch(removeInviteUser(roomID, { invitee: user.email }));\n              }}\n            >\n              <CloseIcon />\n            </IconButton>\n          </Row>\n        ))}\n        <TextField\n          error={email.err_message.length > 0}\n          value={email.str}\n          onChange={(value) => {\n            const email = value.target.value;\n            setEmail({ str: email, err_message: \"\" });\n          }}\n          helperText={email.err_message}\n        />\n        <IconButton onClick={invite}>\n          <SendIcon />\n        </IconButton>\n      </DialogContent>\n    </Dialog>\n  );\n};\n\nexport default InviteModal;\n","import {\n  Grid,\n  IconButton,\n  makeStyles,\n  Paper,\n  Typography,\n  Tooltip,\n  Menu,\n  MenuItem,\n} from \"@material-ui/core\";\nimport React, { useState } from \"react\";\nimport { red } from \"@material-ui/core/colors\";\nimport MicIcon from \"@material-ui/icons/Mic\";\nimport CallEndIcon from \"@material-ui/icons/CallEnd\";\nimport MicOffIcon from \"@material-ui/icons/MicOff\";\nimport VideocamOutlinedIcon from \"@material-ui/icons/VideocamOutlined\";\nimport VideocamOffOutlinedIcon from \"@material-ui/icons/VideocamOffOutlined\";\nimport MessageOutlinedIcon from \"@material-ui/icons/MessageOutlined\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { toggleAudio, toggleVideo } from \"../../redux/actions/roomActions\";\nimport { useHistory } from \"react-router\";\nimport InfoOutlinedIcon from \"@material-ui/icons/InfoOutlined\";\nimport PersonAddIcon from \"@material-ui/icons/PersonAdd\";\nimport DetailModal from \"./DetailModal\";\nimport InviteModal from \"./InviteModal\";\nimport { useMediaQuery } from \"@material-ui/core\";\nimport { useTheme } from \"@material-ui/styles\";\nimport MoreVertIcon from \"@material-ui/icons/MoreVert\";\n\nconst useStyles = makeStyles((theme) => ({\n  container: {\n    minHeight: \"3rem\",\n    flexGrow: 0,\n    background: theme.palette.background.default,\n  },\n  blue: { background: \"blue\" },\n  orange: {\n    color: red[500],\n  },\n  right: { marginRight: \"1rem\" },\n}));\n\nconst Controls = ({ switchc, toggleChat }) => {\n  const classes = useStyles();\n  const dispatch = useDispatch();\n  const isAudioOn = useSelector((state) => state.roomReducer.userVideo.audioOn);\n  const isVideoOn = useSelector((state) => state.roomReducer.userVideo.videoOn);\n  const [detailModalOpen, setDetailModalOpen] = useState(false);\n  const [inviteModalOpen, setInviteModalOpen] = useState(false);\n  const history = useHistory();\n  const roomName = useSelector(\n    (state) => state.roomReducer.currentRoom.room_name\n  );\n  const isUserCreator = useSelector((state) => state.roomReducer.isUserCreator);\n  const leftRoom = () => {\n    history.replace(\"/\");\n  };\n  const theme = useTheme();\n  const isMobile = useMediaQuery(theme.breakpoints.down(\"sm\"));\n  const [anchorEl, setAnchorEl] = React.useState(null);\n  const isMenuOpen = Boolean(anchorEl);\n\n  return (\n    <Paper elevation={3} className={classes.container}>\n      <Grid\n        justify=\"space-between\"\n        container\n        alignItems=\"center\"\n        style={{ height: \"100%\" }}\n      >\n        <div>\n          <Typography variant=\"h5\" style={{ marginLeft: \"1rem\" }}>\n            {roomName}\n          </Typography>\n        </div>\n        <div>\n          <Tooltip title={isAudioOn ? \"Mic On\" : \"Mic off\"}>\n            <IconButton\n              color=\"inherit\"\n              onClick={() => {\n                dispatch(toggleAudio());\n              }}\n            >\n              {isAudioOn ? <MicIcon /> : <MicOffIcon />}\n            </IconButton>\n          </Tooltip>\n          <Tooltip title=\"end call\">\n            <IconButton color=\"inherit\" onClick={leftRoom}>\n              <CallEndIcon className={classes.orange} />\n            </IconButton>\n          </Tooltip>\n          <Tooltip title={isVideoOn ? \"video on\" : \"video off\"}>\n            <IconButton\n              color=\"inherit\"\n              onClick={() => {\n                dispatch(toggleVideo());\n              }}\n            >\n              {isVideoOn ? (\n                <VideocamOutlinedIcon />\n              ) : (\n                <VideocamOffOutlinedIcon />\n              )}\n            </IconButton>\n          </Tooltip>\n        </div>\n        {!isMobile && (\n          <div className={classes.right}>\n            {isUserCreator && (\n              <Tooltip title=\"invite users\">\n                <IconButton\n                  onClick={() => {\n                    setInviteModalOpen((o) => !o);\n                  }}\n                >\n                  <PersonAddIcon />\n                </IconButton>\n              </Tooltip>\n            )}\n            <Tooltip title=\"Meeting Details\">\n              <IconButton\n                onClick={() => {\n                  setDetailModalOpen((o) => !o);\n                }}\n              >\n                <InfoOutlinedIcon />\n              </IconButton>\n            </Tooltip>\n            <Tooltip title=\"Chat\">\n              <IconButton onClick={toggleChat}>\n                <MessageOutlinedIcon />\n              </IconButton>\n            </Tooltip>\n          </div>\n        )}\n        {isMobile && (\n          <div className={classes.right}>\n            <IconButton\n              aria-controls=\"simple-theme-menu\"\n              aria-haspopup=\"true\"\n              color=\"inherit\"\n              className=\"header-title-button\"\n              onClick={(event) => setAnchorEl(event.currentTarget)}\n            >\n              <MoreVertIcon />\n            </IconButton>\n            <Menu\n              anchorEl={anchorEl}\n              id={\"controls-menu\"}\n              keepMounted\n              open={isMenuOpen}\n              onClose={() => {\n                setAnchorEl(null);\n              }}\n            >\n              <MenuItem\n                onClick={() => {\n                  setAnchorEl(null);\n                  setInviteModalOpen((o) => !o);\n                }}\n              >\n                Invite User\n              </MenuItem>\n              <MenuItem\n                onClick={() => {\n                  setAnchorEl(null);\n                  setDetailModalOpen((o) => !o);\n                }}\n              >\n                Meeting Details\n              </MenuItem>\n              <MenuItem\n                onClick={() => {\n                  setAnchorEl(null);\n                  toggleChat();\n                }}\n              >\n                Chat\n              </MenuItem>\n            </Menu>\n          </div>\n        )}\n        {isUserCreator && (\n          <InviteModal open={inviteModalOpen} setOpen={setInviteModalOpen} />\n        )}\n        <DetailModal open={detailModalOpen} setOpen={setDetailModalOpen} />\n      </Grid>\n    </Paper>\n  );\n};\n\nexport default Controls;\n","export const split = (x) => {\n  let n = Math.floor(Math.sqrt(x));\n  let zp = n - (x % n);\n  let pp = Math.floor(x / n);\n  let m = [];\n  for (let i = 0; i < n; i++) {\n    if (i >= zp) {\n      m.push(pp + 1);\n    } else {\n      m.push(pp);\n    }\n  }\n  m = m.reverse();\n  let res = {};\n  let count = 1;\n  let idx = 0;\n  for (let i = 1; i <= x; i++) {\n    res[i] = m[idx];\n    count++;\n    if (count > m[idx]) {\n      count = 1;\n      idx++;\n    }\n  }\n  res[\"rows\"] = m.length;\n  return res;\n};\n\nexport function detectURL(message) {\n  var urlRegex = /(((https?:\\/\\/)|(www\\.))[^\\s]+)/g;\n  return message.replace(urlRegex, function (urlMatch) {\n    return `<a href=${urlMatch} target=\"_blank\" >${urlMatch}</a>`;\n  });\n}\nexport function sanitize(string) {\n  const map = {\n    \"&\": \"&amp;\",\n    \"<\": \"&lt;\",\n    \">\": \"&gt;\",\n    '\"': \"&quot;\",\n    \"'\": \"&#x27;\",\n    \"/\": \"&#x2F;\",\n  };\n  const reg = /[&<>\"'/]/gi;\n  return string.replace(reg, (match) => map[match]);\n}\n\nexport const getFullName = (firstName, lastName) => {\n  const fullName = firstName + \" \" + lastName;\n  return fullName.trim();\n};\n","import React, { useCallback, useEffect, useState } from \"react\";\nimport Drawer from \"@material-ui/core/Drawer\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport { IconButton } from \"@material-ui/core\";\nimport ChevronRightIcon from \"@material-ui/icons/ChevronRight\";\nimport WebSocketService from \"../../helper/WebsocketService\";\nimport TextField from \"@material-ui/core/TextField\";\nimport { Send } from \"@material-ui/icons\";\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\nimport { useSelector } from \"react-redux\";\nimport \"./chat.css\";\nconst drawerWidth = 360;\n\nconst useStyles = makeStyles((theme) => ({\n  drawer: {\n    width: drawerWidth,\n    flexShrink: 0,\n  },\n  drawerPaper: {\n    width: drawerWidth,\n    height: \"calc(100vh - 9rem)\",\n    borderRadius: \"1rem\",\n    top: \"5rem\",\n    right: \"12px\",\n  },\n  drawerHeader: {\n    display: \"flex\",\n    alignItems: \"center\",\n    padding: theme.spacing(0, 1),\n    ...theme.mixins.toolbar,\n    justifyContent: \"flex-start\",\n  },\n  chatInputContainer: {\n    marginTop: \"auto\",\n  },\n  chatInput: {\n    marginBottom: \"2rem\",\n    \"& .MuiFilledInput-root\": {\n      borderRadius: \"50px\",\n      borderBottom: 0,\n      paddingTop: \"15px\",\n      paddingBottom: \"15px\",\n      \"&::before\": { borderBottom: 0 },\n    },\n  },\n  messageBoxRight: {\n    background: theme.palette.background.paper,\n    color: theme.palette.text.primary,\n  },\n  messageBoxLeft: {\n    background: \"#4870df\",\n    color: theme.palette.background.default,\n  },\n  messageSender: {\n    color: theme.palette.text.primary,\n    fontSize: \"10px\",\n  },\n}));\n\nconst MessageItem = (props) => {\n  const owner = useSelector((state) => state.userReducer.user);\n  const classes = useStyles();\n  let messagePosition =\n    owner.pk === props.sender.id\n      ? `chatApp__convMessageItem--right`\n      : `chatApp__convMessageItem--left`;\n  let messageBackground =\n    owner.pk === props.sender.id\n      ? classes.messageBoxRight\n      : classes.messageBoxLeft;\n  return (\n    <div\n      className={\"chatApp__convMessageItem \" + messagePosition + \" clearfix\"}\n    >\n      <div className={`chatApp__convMessageValue ${messageBackground}`}>\n        {owner.pk !== props.sender.id && (\n          <div className={classes.messageSender}>{props.sender.first_name}</div>\n        )}\n        <div>{props.message}</div>\n      </div>\n    </div>\n  );\n};\n\nconst MessageList = React.memo((props) => {\n  return (\n    <div className={\"chatApp__convTimeline\"}>\n      {props.messages\n        .slice(0)\n        .reverse()\n        .map((messageItem, idx) => (\n          <MessageItem\n            key={idx}\n            sender={messageItem.sender}\n            senderAvatar={messageItem.senderAvatar}\n            message={messageItem.message}\n          />\n        ))}\n    </div>\n  );\n});\n\nconst Chat = ({ open, setOpen }) => {\n  const [messages, setMessages] = useState([]);\n  const [currMessage, setCurrMessage] = useState(\"\");\n  const classes = useStyles();\n  useEffect(() => {\n    WebSocketService.on(\"receive new message\", (data) => {\n      setMessages((messages) => [...messages, data]);\n    });\n  }, []);\n  const sendMessage = () => {\n    WebSocketService.sendMessage(\"send new message\", currMessage);\n    setCurrMessage(\"\");\n  };\n\n  const onCurrMessageChanged = useCallback((e) => {\n    const val = e.target.value;\n    setCurrMessage(val);\n  }, []);\n  return (\n    <Drawer\n      className={classes.drawer}\n      variant=\"persistent\"\n      anchor=\"right\"\n      open={open}\n      classes={{\n        paper: classes.drawerPaper,\n      }}\n    >\n      <div className={classes.drawerHeader}>\n        <IconButton\n          onClick={() => {\n            setOpen(false);\n          }}\n        >\n          <ChevronRightIcon />\n        </IconButton>\n      </div>\n      <MessageList messages={messages} />\n      <div className={classes.chatInputContainer}>\n        <TextField\n          placeholder=\"send a message to everyone\"\n          size=\"small\"\n          variant=\"filled\"\n          fullWidth\n          multiline\n          rowsMax={4}\n          className={classes.chatInput}\n          value={currMessage}\n          onChange={onCurrMessageChanged}\n          InputProps={{\n            endAdornment: (\n              <InputAdornment position=\"end\">\n                {currMessage.length > 0 && (\n                  <IconButton\n                    aria-label=\"toggle password visibility\"\n                    onClick={sendMessage}\n                  >\n                    <Send />\n                  </IconButton>\n                )}\n              </InputAdornment>\n            ),\n          }}\n        />\n      </div>\n    </Drawer>\n  );\n};\n\nexport default Chat;\n","import { toast } from \"react-toastify\";\nimport WebsocketService from \"./WebsocketService\";\nimport { getFullName } from \"../helper/utilFunctions\";\nimport { getUniqueArray } from \"./helperFunctions\";\nimport { addPeer, createPeer } from \"./peers\";\n\nexport const all_users_listener =\n  (peersRef, myID, stream, setPeers) => (users) => {\n    peersRef.current = {};\n    const temp = {};\n    users.forEach((user) => {\n      if (myID !== user.id) {\n        const peer = createPeer(user.id, myID, stream);\n\n        peersRef.current[user.id] = { user, peer };\n        temp[user.id] = {\n          user: user,\n          peer: peer,\n        };\n      }\n    });\n    setPeers(temp);\n  };\n\nexport const user_joined_listener =\n  (myID, peersRef, stream, setPeers, isUserAudioOn, isUserVideoOn) =>\n  (payload) => {\n    const user = payload.callerUser;\n    if (payload.usable_id === myID) {\n      const peer = addPeer(payload.signal, user.id, stream);\n      if (!Boolean(peersRef.current[user.id])) {\n        peersRef.current[user.id] = { user, peer };\n        setPeers((peers) => ({\n          ...peers,\n          [user.id]: {\n            user: user,\n            peer: peer,\n          },\n        }));\n      }\n      WebsocketService.sendMessage(\"audioMedia\", {\n        userID: myID,\n        audioOn: isUserAudioOn,\n      });\n      WebsocketService.sendMessage(\"videoMedia\", {\n        userID: myID,\n        videoOn: isUserVideoOn,\n      });\n      toast.info(`${getFullName(user.first_name, user.last_name)} joined`);\n    }\n  };\n\nexport const receive_returned_signal = (myID, peersRef) => (payload) => {\n  if (payload.usable_id === myID) {\n    const { peer } = peersRef.current[payload.id];\n    peer.signal(payload.signal);\n  }\n};\n\nexport const user_left_listener = (myID, peersRef, setPeers) => (payload) => {\n  const user = payload.user;\n  if (peersRef.current[user.id]) {\n    peersRef.current[user.id].peer.destroy();\n  }\n  delete peersRef.current[user.id];\n  setPeers((peers) => {\n    const { [payload.user.id]: remove, ...rest } = peers;\n    return rest;\n  });\n  if (payload.user.id !== myID) {\n    toast.info(`${getFullName(user.first_name, user.last_name)} left`);\n  }\n};\n\nexport const videoMediaListener = (peersRef, setPeers) => (payload) => {\n  const userID = payload.userID;\n  if (peersRef.current[userID]) {\n    peersRef.current[userID].user.videoOn = payload.videoOn;\n    setPeers((peers) => {\n      const { user, peer } = peers[userID];\n      return {\n        ...peers,\n        [userID]: { peer, user: { ...user, videoOn: payload.videoOn } },\n      };\n    });\n  }\n};\n\nexport const audioMediaListener = (peersRef, setPeers) => (payload) => {\n  const userID = payload.userID;\n  if (peersRef.current[userID]) {\n    peersRef.current[userID].user.audioOn = payload.audioOn;\n    setPeers((peers) => {\n      const { user, peer } = peers[userID];\n      return {\n        ...peers,\n        [userID]: { peer, user: { ...user, audioOn: payload.audioOn } },\n      };\n    });\n  }\n};\n\nexport const getPermissionListener = (myID, setAcceptStatus) => (payload) => {\n  if (payload.usable_id === myID) {\n    setAcceptStatus(payload.status);\n  }\n};\n\nexport const getPermissionRequestListener =\n  (myID, setWaitingUsers) => (payload) => {\n    if (payload.usable_id === myID) {\n      setWaitingUsers((users) => {\n        users.push(payload.user);\n        const newUsers = getUniqueArray(users, \"id\");\n        return newUsers;\n      });\n    }\n  };\n\nexport const userKickedListener = (myID, history) => (payload) => {\n  if (payload.usable_id === myID) {\n    history.replace(\"/\", {\n      message: \"The Organisor removed you from room\",\n      type: \"error\",\n    });\n  }\n};\n\nexport const userBlockedListener = (myID, history) => (payload) => {\n  if (payload.usable_id === myID) {\n    history.replace(\"/\", {\n      message: \"The Organisor blocked you from room\",\n      type: \"error\",\n    });\n  }\n};\n\nexport const joinMessageListener =\n  (setAcceptStatus, setServerMessage) => (message) => {\n    setAcceptStatus(\"message\");\n    if (message === \"creator not available\") {\n      setServerMessage(\n        \"The Organisor has not joined the room yet. Please try joining after some time\"\n      );\n    } else if (message === \"user blocked\") {\n      setServerMessage(\"The Organisor has blocked you.\");\n    }\n  };\n","import Peer from \"simple-peer\";\nimport WebsocketService from \"./WebsocketService\";\n\nexport function createPeer(userToSignal, callerID, stream) {\n  const peer = new Peer({\n    initiator: true,\n    trickle: false,\n    stream,\n  });\n  peer.on(\"signal\", (signal) => {\n    WebsocketService.sendMessage(\"sending signal\", {\n      userToSignal,\n      callerID,\n      signal,\n    });\n  });\n  return peer;\n}\n\nexport function addPeer(incomingSignal, callerID, stream) {\n  const peer = new Peer({\n    initiator: false,\n    trickle: false,\n    stream,\n  });\n  peer.on(\"signal\", (signal) => {\n    WebsocketService.sendMessage(\"returning signal\", { signal, callerID });\n  });\n  peer.signal(incomingSignal);\n  return peer;\n}\n","import { IconButton } from \"@material-ui/core\";\nimport React from \"react\";\nimport { Modal, Row, Col } from \"react-bootstrap\";\nimport CloseIcon from \"@material-ui/icons/Close\";\nimport CheckIcon from \"@material-ui/icons/Check\";\nimport { makeStyles } from \"@material-ui/styles\";\nimport WebSocketInstance from \"../../helper/WebsocketService\";\n\nconst useStyles = makeStyles((theme) => ({\n  modal: {\n    \"&& .modal-content\": {\n      background: theme.palette.background.paper,\n      color: theme.palette.text.primary,\n    },\n  },\n}));\n\nconst JoinModal = ({ waitingUsers, setWaitingUsers }) => {\n  const classes = useStyles();\n  const rejectUser = (user) => {\n    WebSocketInstance.sendMessage(\"give join permission status\", {\n      userID: user.id,\n      status: \"reject\",\n    });\n    setWaitingUsers((users) => users.filter((el) => el.id !== user.id));\n  };\n  const acceptUser = (user) => {\n    WebSocketInstance.sendMessage(\"give join permission status\", {\n      userID: user.id,\n      status: \"accept\",\n    });\n    setWaitingUsers((users) => users.filter((el) => el.id !== user.id));\n  };\n  return (\n    <Modal\n      show={Boolean(waitingUsers.length)}\n      onHide={() => {}}\n      backdrop=\"static\"\n      keyboard={false}\n      className={classes.modal}\n    >\n      <Modal.Header>\n        <Modal.Title>Modal title</Modal.Title>\n      </Modal.Header>\n      <Modal.Body>\n        {waitingUsers.map((user, idx) => (\n          <Row key={idx} style={{ alignItems: \"center\" }}>\n            <Col>{user.first_name} wants to join</Col>\n            <IconButton\n              onClick={() => {\n                rejectUser(user);\n              }}\n            >\n              <CloseIcon />\n            </IconButton>\n            <IconButton\n              onClick={() => {\n                acceptUser(user);\n              }}\n            >\n              <CheckIcon />\n            </IconButton>\n          </Row>\n        ))}\n      </Modal.Body>\n      <Modal.Footer></Modal.Footer>\n    </Modal>\n  );\n};\n\nexport default JoinModal;\n","export const updateStream = (peersRef, setPeers, userStream) => (stream) => {\n  for (let key in peersRef.current) {\n    // peersRef.current[key].removeTrack(\n    //   // userStream.getVideoTracks()[0],\n    //   peersRef.current[key].streams[0].getVideoTracks()[0],\n    //   userStream\n    // );\n    // peersRef.current[key].addTrack(stream.getVideoTracks()[0], userStream);\n    // peersRef.current[key]._pc.getSenders().forEach((sender) => {\n    //   if (sender.track.type === \"video\") {\n    //     sender.replaceTrack(userStream.getVideoTracks()[0]);\n    //   }\n    // });\n    peersRef.current[key].peer.streams.forEach((stream) => {\n      stream.getTracks().forEach((track) => {\n        track.stop();\n      });\n    });\n  }\n  setPeers({ ...peersRef.current });\n  userStream.removeTrack(userStream.getVideoTracks()[0]);\n  userStream.addTrack(stream.getVideoTracks()[0]);\n};\n\nexport const switchCamera = (videoConstraints) => async (currentCameraRef) => {\n  const devices = await navigator.mediaDevices.enumerateDevices();\n  const videoDevices = devices.filter((device) => device.kind === \"videoinput\");\n  currentCameraRef.current =\n    (currentCameraRef.current + 1) % videoDevices.length;\n\n  const updatedConstraints = {\n    ...videoConstraints,\n    deviceId: {\n      exact: videoDevices[currentCameraRef.current].deviceId,\n    },\n  };\n  videoConstraints = updatedConstraints;\n\n  const stream = await navigator.mediaDevices.getUserMedia({\n    video: videoConstraints,\n    audio: true,\n  });\n  updateStream(stream);\n};\n\nexport const shareScreen = (peersRef, userStream) => () => {\n  navigator.mediaDevices\n    .getDisplayMedia({ cursor: true })\n    .then((screenStream) => {\n      // const temp = {};\n      Object.keys(peersRef.current).forEach((key) => {\n        // let peer = peersRef.current[key];\n        peersRef.current[key].replaceTrack(\n          userStream.getVideoTracks()[0],\n          screenStream.getVideoTracks()[0],\n          userStream\n        );\n        // temp[key] = peer;\n      });\n    });\n};\n","import React, { useEffect, useRef, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport WebsocketService from \"../helper/WebsocketService\";\nimport { useParams } from \"react-router\";\nimport Video from \"../components/common/Video\";\nimport Controls from \"../components/Room/Controls\";\nimport { split } from \"../helper/utilFunctions\";\nimport Chat from \"../components/Room/Chat\";\nimport { makeStyles } from \"@material-ui/core\";\nimport {\n  all_users_listener,\n  user_joined_listener,\n  user_left_listener,\n  receive_returned_signal,\n  videoMediaListener,\n  audioMediaListener,\n  getPermissionRequestListener,\n} from \"../helper/socketListeners\";\nimport JoinModal from \"../components/Room/JoinModal\";\nimport { switchCamera } from \"../helper/unusedFunctions\";\nimport { getIsUserCreator, getRoom } from \"../redux/actions/roomActions\";\n\nlet videoConstraints = {\n  height: window.innerHeight / 2,\n  width: window.innerWidth / 2,\n};\n\nconst useStyles = makeStyles((theme) => ({\n  container: {\n    display: \"flex\",\n    height: \"100%\",\n    width: \"100%\",\n    flexDirection: \"column\",\n    background: theme.palette.background.default,\n  },\n}));\n\nconst socketFunctions = (\n  peersRef,\n  myID,\n  stream,\n  setPeers,\n  isUserAudioOn,\n  isUserVideoOn,\n  setWaitingUsers\n) => {\n  WebsocketService.on(\n    \"all users\",\n    all_users_listener(peersRef, myID, stream, setPeers)\n  );\n  WebsocketService.on(\n    \"user joined\",\n    user_joined_listener(\n      myID,\n      peersRef,\n      stream,\n      setPeers,\n      isUserAudioOn,\n      isUserVideoOn\n    )\n  );\n\n  WebsocketService.on(\n    \"receiving returned signal\",\n    receive_returned_signal(myID, peersRef)\n  );\n\n  WebsocketService.on(\n    \"user left\",\n    user_left_listener(myID, peersRef, setPeers)\n  );\n\n  WebsocketService.on(\"videoMedia\", videoMediaListener(peersRef, setPeers));\n\n  WebsocketService.on(\"audioMedia\", audioMediaListener(peersRef, setPeers));\n  WebsocketService.on(\n    \"user want to join\",\n    getPermissionRequestListener(myID, setWaitingUsers)\n  );\n};\n\nconst Room = () => {\n  const { roomID } = useParams();\n  const [peers, setPeers] = useState({});\n  const userVideo = useRef();\n  const socketRef = useRef(WebsocketService);\n  const peersRef = useRef({});\n  const myID = useSelector((state) => state.userReducer.user.pk);\n  const [userStream, setUserStream] = useState();\n  const currentCameraRef = useRef(0);\n  let sizeMap = split(Object.keys(peers).length + 1);\n  const [chatOpen, setChatOpen] = useState(false);\n  const isUserAudioOn = useSelector(\n    (state) => state.roomReducer.userVideo.audioOn\n  );\n  const isUserVideoOn = useSelector(\n    (state) => state.roomReducer.userVideo.videoOn\n  );\n  const classes = useStyles();\n  const me = useSelector((state) => state.userReducer.user);\n  const [waitingUsers, setWaitingUsers] = useState([]);\n  const dispatch = useDispatch();\n\n  const setCameraStream = async () => {\n    const stream = await navigator.mediaDevices.getUserMedia({\n      video: videoConstraints,\n      audio: true,\n    });\n    setUserStream(stream);\n    if (userVideo && userVideo.current) {\n      userVideo.current.srcObject = stream;\n    }\n  };\n\n  const socketConnect = async () => {\n    await setCameraStream();\n    socketRef.current.sendMessage(\"join room\", roomID);\n  };\n\n  useEffect(() => {\n    dispatch(getIsUserCreator(roomID));\n    dispatch(getRoom(roomID));\n    socketConnect();\n  }, []);\n\n  useEffect(() => {\n    socketFunctions(\n      peersRef,\n      myID,\n      userStream,\n      setPeers,\n      isUserAudioOn,\n      isUserVideoOn,\n      setWaitingUsers\n    );\n  }, [userStream, isUserAudioOn, isUserVideoOn, myID]);\n\n  useEffect(() => {\n    let userStreamRef = userStream;\n    return () => {\n      if (userStreamRef) {\n        userStreamRef.getVideoTracks().forEach((track) => {\n          track.stop();\n        });\n        userStreamRef.getAudioTracks().forEach((track) => {\n          track.stop();\n        });\n      }\n    };\n  }, [userStream]);\n\n  useEffect(() => {\n    if (userStream) {\n      userStream.getAudioTracks()[0].enabled = isUserAudioOn;\n      if (socketRef.current.state() === 1) {\n        socketRef.current.sendMessage(\"audioMedia\", {\n          userID: myID,\n          audioOn: isUserAudioOn,\n        });\n      }\n    }\n  }, [userStream, isUserAudioOn, myID]);\n\n  useEffect(() => {\n    if (userStream) {\n      userStream.getVideoTracks()[0].enabled = isUserVideoOn;\n      if (socketRef.current.state() === 1) {\n        socketRef.current.sendMessage(\"videoMedia\", {\n          userID: myID,\n          videoOn: isUserVideoOn,\n        });\n      }\n    }\n  }, [userStream, isUserVideoOn, myID]);\n\n  useEffect(() => {\n    sizeMap = split(Object.keys(peers).length + 1);\n  }, [peers]);\n\n  return (\n    <div className={classes.container}>\n      <div\n        style={{\n          display: \"flex\",\n          width: \"100%\",\n          maxHeight: \"calc(100vh - 7rem)\",\n          margin: \"auto\",\n          flexGrow: \"1\",\n          flexWrap: \"wrap\",\n        }}\n      >\n        <Video\n          muted\n          ref={userVideo}\n          user={{ ...me, videoOn: isUserVideoOn, audioOn: isUserAudioOn }}\n          autoPlay\n          playsInline\n          size={sizeMap[1]}\n          rows={sizeMap[\"rows\"]}\n          isUserVideo\n        />\n        {Object.values(peersRef.current).map((item, index) => {\n          return (\n            <Video\n              key={index}\n              peer={item.peer}\n              user={item.user}\n              size={sizeMap[index + 2]}\n              rows={sizeMap[\"rows\"]}\n            />\n          );\n        })}\n      </div>\n      <JoinModal\n        waitingUsers={waitingUsers}\n        setWaitingUsers={setWaitingUsers}\n      />\n      <Controls\n        switchc={() => {\n          switchCamera(videoConstraints)(currentCameraRef);\n        }}\n        toggleChat={() => {\n          setChatOpen((open) => !open);\n        }}\n      />\n      <Chat open={chatOpen} setOpen={setChatOpen} />\n    </div>\n  );\n};\n\nexport default Room;\n","import React, { useEffect, useState } from \"react\";\nimport WebSocketInstance from \"../helper/WebsocketService\";\nimport { useHistory, useParams } from \"react-router\";\nimport Room from \"./RoomView\";\nimport {\n  getPermissionListener,\n  joinMessageListener,\n  userBlockedListener,\n  userKickedListener,\n} from \"../helper/socketListeners\";\nimport { useSelector } from \"react-redux\";\nimport Typography from \"@material-ui/core/Typography\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport { makeStyles } from \"@material-ui/styles\";\nimport { Paper } from \"@material-ui/core\";\nconst useStyles = makeStyles((theme) => ({\n  container: {\n    background: theme.palette.background.default,\n    height: \"100%\",\n    width: \"100%\",\n    position: \"relative\",\n  },\n  color: { color: theme.palette.text.primary },\n  paper: {\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    maxWidth: \"75vw\",\n    position: \"relative\",\n    marginLeft: \"auto\",\n    marginRight: \"auto\",\n    top: \"3rem\",\n  },\n}));\n\nconst View = () => {\n  const { roomID } = useParams();\n  const history = useHistory();\n  const classes = useStyles();\n  const myID = useSelector((state) => state.userReducer.user.pk);\n  const [acceptStatus, setAcceptStatus] = useState(\"pending\");\n  const [serverMessage, setServerMessage] = useState(\"\");\n  useEffect(() => {\n    WebSocketInstance.refresh();\n    let protocol = window.location.protocol === \"http:\" ? \"ws\" : \"wss\";\n    let host = window.location.hostname.includes(\"localhost\")\n      ? \"localhost:7000\"\n      : window.location.hostname;\n    WebSocketInstance.connect(\n      `${protocol}://${host}/ws/room/${roomID}/`,\n      (e) => {\n        history.replace(\"/\", {\n          message: \"the url entered is incorrect.\",\n          type: \"error\",\n        });\n      }\n    );\n    WebSocketInstance.on(\n      \"get permission\",\n      getPermissionListener(myID, setAcceptStatus)\n    );\n    WebSocketInstance.on(\n      \"join message\",\n      joinMessageListener(setAcceptStatus, setServerMessage)\n    );\n    WebSocketInstance.on(\"user kicked\", userKickedListener(myID, history));\n    WebSocketInstance.on(\"user blocked\", userBlockedListener(myID, history));\n    return () => {\n      WebSocketInstance.close();\n    };\n  }, []);\n\n  useEffect(() => {\n    if (acceptStatus === \"reject\") {\n      history.replace(\"/\", {\n        message: \"The creator rejected the join request\",\n        type: \"error\",\n      });\n    }\n  }, [acceptStatus]);\n\n  return (\n    <>\n      {acceptStatus === \"pending\" ? (\n        <div className={classes.container}>\n          <Paper elevation={3} variant=\"outlined\" className={classes.paper}>\n            <Typography\n              variant=\"h2\"\n              className={classes.color}\n              style={{ width: \"max-content\" }}\n            >\n              Joining the room\n            </Typography>\n            <CircularProgress\n              className={classes.color}\n              style={{ marginLeft: \"1rem\" }}\n            />\n          </Paper>\n        </div>\n      ) : acceptStatus === \"accept\" ? (\n        <Room />\n      ) : acceptStatus === \"message\" ? (\n        <div className={classes.container}>\n          <Paper elevation={3} variant=\"outlined\" className={classes.paper}>\n            <Typography\n              variant=\"h2\"\n              className={classes.color}\n              style={{ width: \"max-content\" }}\n              align=\"center\"\n            >\n              {serverMessage}\n            </Typography>\n          </Paper>\n        </div>\n      ) : null}\n    </>\n  );\n};\n\nexport default View;\n"],"sourceRoot":""}