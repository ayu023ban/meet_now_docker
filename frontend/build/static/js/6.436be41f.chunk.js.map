{"version":3,"sources":["redux/actions/roomActions.js","helper/WebsocketService.js","components/common/Video.js","components/Room/DetailModal.js","components/Room/InviteModal.js","components/Room/Controls.js","helper/utilFunctions.js","components/Room/Chat.js","helper/socketListeners.js","helper/peers.js","components/Room/JoinModal.js","helper/unusedFunctions.js","views/RoomView.js","views/View.js"],"names":["createNewRoom","data","url","create_room","dispatch","apiClient","post","then","res","apiDispatch","CREATE_ROOM","navigator","clipboard","writeText","getUrlFromCode","id","toast","success","catch","err","error","getRooms","get_room","get","GET_ROOMS","deleteRoom","roomID","fallback","getState","delete","getRoom","GET_ROOM","toggleAudio","TOGGLE_USER_AUDIO","toggleVideo","TOGGLE_USER_VIDEO","inviteUser","roomId","invite","response","removeInviteUser","removeInvite","getInvitations","getIsUserCreator","isUserCreator","SET_USER_IS_CREATOR","isCreator","WebSocketService","callbacks","this","socketRef","forcedClose","chatroom_url","WebSocket","onopen","console","log","onmessage","e","socketNewMessage","onerror","debug","onclose","code","setTimeout","connect","reason","close","command","func","received_data","parsedData","JSON","parse","Object","keys","length","type","waitForConnection","send","stringify","bind","message","readyState","callback","interval","state","that","instance","WebSocketInstance","getInstance","useStyles","makeStyles","theme","responsive","size","rows","float","width","height","display","alignItems","videoTop","background","palette","paper","micOff","position","right","top","videoOff","left","justifyContent","avatar","fontSize","hoverDiv","remove","color","name","bottom","Video","React","forwardRef","ref","peer","muted","isUserVideo","user","localRef","useRef","currentRef","classes","useState","open","setOpen","useSelector","roomReducer","invitedUsers","currentRoom","invited_users","mangoRef","videoWidth","current","getBoundingClientRect","videoHeight","initials","first_name","toUpperCase","last_name","fullName","trim","useEffect","on","stream","srcObject","className","style","overflow","margin","borderRadius","objectFit","transform","videoOn","playsInline","autoPlay","onClick","onMouseEnter","Fade","in","onMouseLeave","opacity","Tooltip","title","IconButton","sendMessage","userID","disabled","some","el","Typography","variant","audioOn","Avatar","DetailModal","roomName","room_name","Dialog","onClose","o","aria-labelledby","aria-describedby","DialogTitle","DialogContent","DialogContentText","window","location","href","DialogActions","text","onCopy","Button","InviteModal","useParams","str","err_message","email","setEmail","useDispatch","map","idx","Row","Col","invitee","TextField","value","onChange","target","helperText","validateEmailAddress","container","minHeight","flexGrow","default","blue","orange","red","marginRight","Controls","switchc","toggleChat","isAudioOn","userVideo","isVideoOn","detailModalOpen","setDetailModalOpen","inviteModalOpen","setInviteModalOpen","history","useHistory","useTheme","isMobile","useMediaQuery","breakpoints","down","anchorEl","setAnchorEl","isMenuOpen","Boolean","Paper","elevation","Grid","justify","marginLeft","replace","aria-controls","aria-haspopup","event","currentTarget","Menu","keepMounted","MenuItem","split","x","n","Math","floor","sqrt","zp","pp","m","i","push","reverse","count","getFullName","firstName","lastName","drawer","flexShrink","drawerPaper","drawerHeader","padding","spacing","mixins","toolbar","chatInputContainer","marginTop","chatInput","marginBottom","borderBottom","paddingTop","paddingBottom","messageBoxRight","primary","messageBoxLeft","messageSender","MessageItem","props","owner","userReducer","messagePosition","pk","sender","messageBackground","MessageList","memo","messages","slice","messageItem","senderAvatar","Chat","setMessages","currMessage","setCurrMessage","onCurrMessageChanged","useCallback","val","Drawer","anchor","placeholder","fullWidth","multiline","rowsMax","InputProps","endAdornment","InputAdornment","aria-label","all_users_listener","peersRef","myID","setPeers","users","temp","forEach","userToSignal","callerID","Peer","initiator","trickle","signal","WebsocketService","createPeer","user_joined_listener","isUserAudioOn","isUserVideoOn","payload","callerUser","usable_id","incomingSignal","addPeer","peers","info","modal","JoinModal","waitingUsers","setWaitingUsers","Modal","show","onHide","backdrop","keyboard","Header","Title","Body","status","filter","rejectUser","acceptUser","Footer","updateStream","userStream","key","streams","getTracks","track","stop","removeTrack","getVideoTracks","addTrack","videoConstraints","innerHeight","innerWidth","flexDirection","socketFunctions","receive_returned_signal","destroy","user_left_listener","videoMediaListener","audioMediaListener","getUniqueArray","getPermissionRequestListener","Room","setUserStream","currentCameraRef","sizeMap","chatOpen","setChatOpen","me","setCameraStream","a","mediaDevices","getUserMedia","video","audio","socketConnect","userStreamRef","getAudioTracks","enabled","maxHeight","flexWrap","values","item","index","enumerateDevices","devices","videoDevices","device","kind","updatedConstraints","deviceId","exact","maxWidth","View","acceptStatus","setAcceptStatus","serverMessage","setServerMessage","refresh","protocol","host","hostname","includes","getPermissionListener","joinMessageListener","userKickedListener","userBlockedListener","CircularProgress","align"],"mappings":"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","file":"static/js/6.436be41f.chunk.js","sourcesContent":["import apiClient from \"../../helper/apiclient\";\nimport { toast } from \"react-toastify\";\n\nimport {\n  CREATE_ROOM,\n  GET_ROOM,\n  GET_ROOMS,\n  SET_USER_IS_CREATOR,\n  TOGGLE_USER_AUDIO,\n  TOGGLE_USER_VIDEO,\n} from \"./roomActionTypes\";\n\nimport {\n  create_room,\n  get_room,\n  invite,\n  isUserCreator,\n  removeInvite,\n} from \"../../config/backend_api\";\n\nimport { apiDispatch, getUrlFromCode } from \"../../helper/helperFunctions\";\nimport { getInvitations } from \"./userActions\";\n\nexport const createNewRoom = (data) => {\n  const url = create_room;\n  return (dispatch) => {\n    apiClient\n      .post(url, data)\n      .then((res) => {\n        dispatch(apiDispatch(CREATE_ROOM, res.data));\n        navigator.clipboard.writeText(getUrlFromCode(res.data.id));\n        toast.success(\"copied to clipboard\");\n      })\n      .catch((err) => {\n        toast.error(`error occured in creating the room`);\n      });\n  };\n};\n\nexport const getRooms = () => {\n  const url = get_room;\n  return (dispatch) => {\n    apiClient\n      .get(url)\n      .then((res) => {\n        dispatch(apiDispatch(GET_ROOMS, res.data));\n      })\n      .catch((err) => {\n        toast.error(`error occured in fetching your rooms`, {});\n      });\n  };\n};\n\nexport const deleteRoom = (roomID, fallback) => {\n  const url = `${get_room}${roomID}/`;\n  return (dispatch, getState) => {\n    apiClient.delete(url).then((res) => {\n      fallback(roomID);\n    });\n  };\n};\n\nexport const getRoom = (roomID) => {\n  const url = `${get_room}${roomID}/`;\n  return (dispatch) => {\n    apiClient.get(url).then((res) => {\n      dispatch(apiDispatch(GET_ROOM, res.data));\n    });\n  };\n};\n\nexport const toggleAudio = () => {\n  return (dispatch) => {\n    dispatch(apiDispatch(TOGGLE_USER_AUDIO));\n  };\n};\nexport const toggleVideo = () => {\n  return (dispatch) => {\n    dispatch(apiDispatch(TOGGLE_USER_VIDEO));\n  };\n};\n\nexport const inviteUser = (roomId, data) => {\n  const url = invite(roomId);\n  return (dispatch) => {\n    apiClient\n      .post(url, data)\n      .then((res) => {\n        dispatch(apiDispatch(GET_ROOM, res.data));\n        toast.success(\"user invited\");\n      })\n      .catch((err) => {\n        toast.error(err.response.data);\n      });\n  };\n};\n\nexport const removeInviteUser = (roomID, data) => {\n  const url = removeInvite(roomID);\n  return (dispatch) => {\n    apiClient\n      .post(url, data)\n      .then((res) => {\n        dispatch(apiDispatch(GET_ROOM, res.data));\n        dispatch(getInvitations());\n      })\n      .catch((err) => {\n        toast.error(err.response.data);\n      });\n  };\n};\n\nexport const getIsUserCreator = (roomId) => {\n  const url = isUserCreator(roomId);\n  return (dispatch) => {\n    apiClient.get(url).then((res) => {\n      dispatch(apiDispatch(SET_USER_IS_CREATOR, res.data.isCreator));\n    });\n  };\n};\n","class WebSocketService {\n  static instance = null;\n  callbacks = {};\n\n  static getInstance() {\n    if (!WebSocketService.instance) {\n      WebSocketService.instance = new WebSocketService();\n    }\n    return WebSocketService.instance;\n  }\n\n  constructor() {\n    this.socketRef = null;\n    this.fallback = null;\n    this.forcedClose = false;\n  }\n\n  connect(chatroom_url, fallback = () => {}) {\n    this.forcedClose = false;\n    this.fallback = fallback;\n    this.socketRef = new WebSocket(chatroom_url);\n\n    this.socketRef.onopen = () => {\n      console.log(\"websocket open\");\n    };\n\n    this.socketRef.onmessage = (e) => {\n      this.socketNewMessage(e.data);\n    };\n\n    this.socketRef.onerror = (e) => {\n      console.debug(e);\n    };\n\n    this.socketRef.onclose = (e) => {\n      console.log(e);\n      if (e.code === 4000) {\n        this.fallback(e);\n      } else if (this.forcedClose) {\n        console.log(\"websocket closed\");\n      } else {\n        console.log(\"websockets closed lets reopen\");\n        setTimeout(() => {\n          this.connect(chatroom_url, fallback(e));\n        }, 5000);\n      }\n    };\n  }\n\n  close(code, reason) {\n    // Default CLOSE_NORMAL code\n    if (typeof code == \"undefined\") {\n      code = 1000;\n    }\n    this.forcedClose = true;\n    if (this.socketRef) {\n      this.socketRef.close(code, reason);\n    }\n  }\n  on(command, func) {\n    this.callbacks[command] = func;\n  }\n\n  socketNewMessage(received_data) {\n    const parsedData = JSON.parse(received_data);\n    const { command, data } = parsedData;\n    if (Object.keys(this.callbacks).length === 0) {\n      return;\n    }\n    if (this.callbacks[command]) {\n      this.callbacks[command](data);\n    }\n  }\n\n  sendMessage(type, data) {\n    try {\n      this.waitForConnection(\n        function () {\n          this.socketRef.send(JSON.stringify({ type, data }));\n        }.bind(this),\n        1000\n      );\n    } catch (err) {\n      console.log(err.message);\n    }\n  }\n  refresh() {\n    if (this.socketRef) {\n      this.socketRef.close();\n    }\n  }\n\n  state() {\n    return this.socketRef.readyState;\n  }\n  waitForConnection(callback, interval) {\n    if (this.state() === 1) {\n      callback();\n    } else {\n      var that = this;\n      // optional: implement backoff for interval here\n      setTimeout(function () {\n        that.waitForConnection(callback, interval);\n      }, interval);\n    }\n  }\n}\n\nconst WebSocketInstance = WebSocketService.getInstance();\n\nexport default WebSocketInstance;\n","import { IconButton, makeStyles, Tooltip, Typography } from \"@material-ui/core\";\nimport React, { useEffect, useRef } from \"react\";\nimport MicOffIcon from \"@material-ui/icons/MicOff\";\nimport Avatar from \"@material-ui/core/Avatar\";\nimport Fade from \"@material-ui/core/Fade\";\nimport RemoveCircleOutlineIcon from \"@material-ui/icons/RemoveCircleOutline\";\nimport WebSocketInstance from \"../../helper/WebsocketService\";\nimport { useSelector } from \"react-redux\";\nimport BlockIcon from \"@material-ui/icons/Block\";\nimport { toast } from \"react-toastify\";\n\nconst useStyles = makeStyles((theme) => ({\n  responsive: ({ size, rows }) => ({\n    float: \"left\",\n    width: `${100 / size - 2}%`,\n    height: `${100 / rows - 2}%`,\n    display: \"flex\",\n    alignItems: \"center\",\n  }),\n  videoTop: {\n    background: theme.palette.background.paper,\n  },\n  micOff: {\n    position: \"absolute\",\n    right: 0,\n    top: 0,\n  },\n  videoOff: {\n    position: \"absolute\",\n    width: \"100%\",\n    height: \"100%\",\n    top: 0,\n    left: 0,\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n  },\n  avatar: {\n    width: \"min(50%, 10rem)\",\n    height: \"min(50%, 10rem)\",\n    fontSize: \"3rem\",\n  },\n  hoverDiv: {\n    position: \"absolute\",\n    top: \"0\",\n    left: \"0\",\n    width: \"100%\",\n    height: \"100%\",\n  },\n  remove: {\n    color: \"white\",\n    \"&:disabled\": { color: \"#444\" },\n  },\n  name: {\n    position: \"absolute\",\n    bottom: \"0.5rem\",\n    left: \"1rem\",\n    color: \"white\",\n  },\n}));\n\nconst Video = React.forwardRef(\n  ({ peer, muted, size, rows, isUserVideo, user }, ref) => {\n    const localRef = useRef(null);\n    const currentRef = ref || localRef;\n    const classes = useStyles({ size, rows });\n    const [open, setOpen] = React.useState(false);\n    const isCreator = useSelector((state) => state.roomReducer.isUserCreator);\n    const invitedUsers = useSelector(\n      (state) => state.roomReducer.currentRoom.invited_users\n    );\n    const mangoRef = useRef(null);\n    const videoWidth = mangoRef.current\n      ? (mangoRef.current.getBoundingClientRect().width * 9) / 16 <\n        mangoRef.current.getBoundingClientRect().height\n        ? `${0.95 * mangoRef.current.getBoundingClientRect().width}px`\n        : `${\n            (0.95 * mangoRef.current.getBoundingClientRect().height * 16) / 9\n          }px`\n      : \"auto\";\n    const videoHeight = mangoRef.current\n      ? (mangoRef.current.getBoundingClientRect().width * 9) / 16 >\n        mangoRef.current.getBoundingClientRect().height\n        ? `${0.95 * mangoRef.current.getBoundingClientRect().height}px`\n        : `${\n            (0.95 * mangoRef.current.getBoundingClientRect().width * 9) / 16\n          }px`\n      : \"auto\";\n    let initials =\n      (user.first_name ? user.first_name[0].toUpperCase() : \"\") +\n      (user.last_name ? user.last_name[0].toUpperCase() : \"\");\n    let fullName = user.first_name + \" \" + user.last_name;\n    fullName = fullName.trim();\n    if (isUserVideo) fullName = \"You\";\n\n    useEffect(() => {\n      if (peer) {\n        peer.on(\"stream\", (stream) => {\n          currentRef.current.srcObject = stream;\n        });\n      }\n    }, []);\n    const removeUser = () => {\n      if (!isCreator || isUserVideo) return;\n      WebSocketInstance.sendMessage(\"user kick\", { userID: user.id });\n    };\n    const blockUser = () => {\n      if (!isCreator || isUserVideo) return;\n      if (invitedUsers.some((el) => el.id === user.id)) {\n        toast.error(\"user is invited. first remove the invitation\");\n      } else {\n        WebSocketInstance.sendMessage(\"user block\", { userID: user.id });\n      }\n    };\n    return (\n      <div className={classes.responsive} ref={mangoRef}>\n        <div\n          className={classes.videoTop}\n          style={{\n            width: videoWidth,\n            height: videoHeight,\n            // paddingTop: \"min(calc(100vh - 9rem), 56.25%)\",\n            position: \"relative\",\n            overflow: \"hidden\",\n            margin: \"auto\",\n            borderRadius: \"1rem\",\n          }}\n        >\n          <video\n            style={{\n              objectFit: \"contain\",\n              transform: isUserVideo ? \"scaleX(-1)\" : 1,\n              position: \"absolute\",\n              top: \"0\",\n              left: \"0\",\n              display: user.videoOn ? \"block\" : \"none\",\n            }}\n            playsInline\n            width=\"100%\"\n            height=\"100%\"\n            autoPlay\n            muted={muted}\n            ref={currentRef}\n            onClick={() => {}}\n            onMouseEnter={() => {\n              setOpen(true);\n            }}\n          />\n          <Fade in={open}>\n            <div\n              className={classes.hoverDiv}\n              onMouseLeave={() => {\n                setOpen(false);\n              }}\n            >\n              <div\n                style={{\n                  opacity: 0.6,\n                  background: \"black\",\n                  width: \"100%\",\n                  height: \"100%\",\n                  display: \"flex\",\n                  justifyContent: \"center\",\n                  alignItems: \"center\",\n                }}\n              >\n                <Tooltip title=\"remove user\">\n                  <IconButton\n                    className={classes.remove}\n                    onClick={removeUser}\n                    disabled={!isCreator || isUserVideo}\n                  >\n                    <RemoveCircleOutlineIcon fontSize=\"large\" />\n                  </IconButton>\n                </Tooltip>\n                <Tooltip title=\"Block user\">\n                  <IconButton\n                    className={classes.remove}\n                    onClick={blockUser}\n                    disabled={!isCreator || isUserVideo}\n                  >\n                    <BlockIcon fontSize=\"large\" />\n                  </IconButton>\n                </Tooltip>\n                <Typography variant=\"p\" className={classes.name}>\n                  {fullName}\n                </Typography>\n              </div>\n            </div>\n          </Fade>\n          {!user.audioOn && (\n            <IconButton className={classes.micOff}>\n              <MicOffIcon />\n            </IconButton>\n          )}\n          {!user.videoOn && (\n            <div className={classes.videoOff}>\n              <Avatar className={classes.avatar}>{initials}</Avatar>\n            </div>\n          )}\n        </div>\n      </div>\n    );\n  }\n);\n\nexport default Video;\n","import React from \"react\";\nimport {\n  Typography,\n  Dialog,\n  DialogContent,\n  DialogContentText,\n  DialogTitle,\n  DialogActions,\n  Button,\n} from \"@material-ui/core\";\nimport { useSelector } from \"react-redux\";\nimport CopyToClipboard from \"react-copy-to-clipboard\";\nimport { toast } from \"react-toastify\";\n\nconst DetailModal = ({ open, setOpen }) => {\n  const roomName = useSelector(\n    (state) => state.roomReducer.currentRoom.room_name\n  );\n  return (\n    <Dialog\n      open={open}\n      onClose={() => {\n        setOpen((o) => !o);\n      }}\n      aria-labelledby=\"alert-dialog-title\"\n      aria-describedby=\"alert-dialog-description\"\n    >\n      <DialogTitle id=\"alert-dialog-title\">{\"Meeting Details\"}</DialogTitle>\n      <DialogContent>\n        <Typography variant=\"h5\">{roomName}</Typography>\n        <br></br>\n        <Typography variant=\"p\">{\"Joining info\"}</Typography>\n        <DialogContentText id=\"alert-dialog-description\">\n          {window.location.href}\n        </DialogContentText>\n      </DialogContent>\n      <DialogActions>\n        <CopyToClipboard\n          text={window.location.href}\n          onCopy={() => {\n            toast.success(\"copied to clipboard\");\n          }}\n        >\n          <Button>Copy link</Button>\n        </CopyToClipboard>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nexport default DetailModal;\n","import React from \"react\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogTitle,\n  IconButton,\n  TextField,\n} from \"@material-ui/core\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { Col, Row } from \"react-bootstrap\";\nimport CloseIcon from \"@material-ui/icons/Close\";\nimport { useState } from \"react\";\nimport SendIcon from \"@material-ui/icons/Send\";\nimport { validateEmailAddress } from \"../../helper/helperFunctions\";\nimport { inviteUser, removeInviteUser } from \"../../redux/actions/roomActions\";\nimport { useParams } from \"react-router\";\n\nconst InviteModal = ({ open, setOpen }) => {\n  const { roomID } = useParams();\n  const invitedUsers = useSelector(\n    (state) => state.roomReducer.currentRoom.invited_users || []\n  );\n  const [email, setEmail] = useState({\n    str: \"\",\n    err_message: \"\",\n  });\n  const dispatch = useDispatch();\n  const invite = () => {\n    const str = email.str;\n    let err_message = \"\";\n    if (str.length === 0) err_message = \"email can't be empty\";\n    else if (!validateEmailAddress(str)) err_message = \"email not valid\";\n    else {\n      dispatch(\n        inviteUser(roomID, {\n          invitee: str,\n        })\n      );\n      setEmail({ str: \"\", err_message: \"\" });\n    }\n    if (err_message.length) {\n      setEmail({ str, err_message });\n    }\n  };\n  return (\n    <Dialog\n      open={open}\n      onClose={() => {\n        setOpen((o) => !o);\n      }}\n    >\n      <DialogTitle>{\"Invite people\"}</DialogTitle>\n      <DialogContent>\n        {invitedUsers.map((user, idx) => (\n          <Row key={idx} style={{ alignItems: \"center\" }}>\n            <Col>{user.email}</Col>\n            <IconButton\n              onClick={() => {\n                dispatch(removeInviteUser(roomID, { invitee: user.email }));\n              }}\n            >\n              <CloseIcon />\n            </IconButton>\n          </Row>\n        ))}\n        <TextField\n          error={email.err_message.length > 0}\n          value={email.str}\n          onChange={(value) => {\n            const email = value.target.value;\n            setEmail({ str: email, err_message: \"\" });\n          }}\n          helperText={email.err_message}\n        />\n        <IconButton onClick={invite}>\n          <SendIcon />\n        </IconButton>\n      </DialogContent>\n    </Dialog>\n  );\n};\n\nexport default InviteModal;\n","import {\n  Grid,\n  IconButton,\n  makeStyles,\n  Paper,\n  Typography,\n  Tooltip,\n  Menu,\n  MenuItem,\n} from \"@material-ui/core\";\nimport React, { useState } from \"react\";\nimport { red } from \"@material-ui/core/colors\";\nimport MicIcon from \"@material-ui/icons/Mic\";\nimport CallEndIcon from \"@material-ui/icons/CallEnd\";\nimport MicOffIcon from \"@material-ui/icons/MicOff\";\nimport VideocamOutlinedIcon from \"@material-ui/icons/VideocamOutlined\";\nimport VideocamOffOutlinedIcon from \"@material-ui/icons/VideocamOffOutlined\";\nimport MessageOutlinedIcon from \"@material-ui/icons/MessageOutlined\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { toggleAudio, toggleVideo } from \"../../redux/actions/roomActions\";\nimport { useHistory } from \"react-router\";\nimport InfoOutlinedIcon from \"@material-ui/icons/InfoOutlined\";\nimport PersonAddIcon from \"@material-ui/icons/PersonAdd\";\nimport DetailModal from \"./DetailModal\";\nimport InviteModal from \"./InviteModal\";\nimport { useMediaQuery } from \"@material-ui/core\";\nimport { useTheme } from \"@material-ui/styles\";\nimport MoreVertIcon from \"@material-ui/icons/MoreVert\";\n\nconst useStyles = makeStyles((theme) => ({\n  container: {\n    minHeight: \"3rem\",\n    flexGrow: 0,\n    background: theme.palette.background.default,\n  },\n  blue: { background: \"blue\" },\n  orange: {\n    color: red[500],\n  },\n  right: { marginRight: \"1rem\" },\n}));\n\nconst Controls = ({ switchc, toggleChat }) => {\n  const classes = useStyles();\n  const dispatch = useDispatch();\n  const isAudioOn = useSelector((state) => state.roomReducer.userVideo.audioOn);\n  const isVideoOn = useSelector((state) => state.roomReducer.userVideo.videoOn);\n  const [detailModalOpen, setDetailModalOpen] = useState(false);\n  const [inviteModalOpen, setInviteModalOpen] = useState(false);\n  const history = useHistory();\n  const roomName = useSelector(\n    (state) => state.roomReducer.currentRoom.room_name\n  );\n  const isUserCreator = useSelector((state) => state.roomReducer.isUserCreator);\n  const leftRoom = () => {\n    history.replace(\"/\");\n  };\n  const theme = useTheme();\n  const isMobile = useMediaQuery(theme.breakpoints.down(\"sm\"));\n  const [anchorEl, setAnchorEl] = React.useState(null);\n  const isMenuOpen = Boolean(anchorEl);\n\n  return (\n    <Paper elevation={3} className={classes.container}>\n      <Grid\n        justify=\"space-between\"\n        container\n        alignItems=\"center\"\n        style={{ height: \"100%\" }}\n      >\n        <div>\n          <Typography variant=\"h5\" style={{ marginLeft: \"1rem\" }}>\n            {roomName}\n          </Typography>\n        </div>\n        <div>\n          <Tooltip title={isAudioOn ? \"Mic On\" : \"Mic off\"}>\n            <IconButton\n              color=\"inherit\"\n              onClick={() => {\n                dispatch(toggleAudio());\n              }}\n            >\n              {isAudioOn ? <MicIcon /> : <MicOffIcon />}\n            </IconButton>\n          </Tooltip>\n          <Tooltip title=\"end call\">\n            <IconButton color=\"inherit\" onClick={leftRoom}>\n              <CallEndIcon className={classes.orange} />\n            </IconButton>\n          </Tooltip>\n          <Tooltip title={isVideoOn ? \"video on\" : \"video off\"}>\n            <IconButton\n              color=\"inherit\"\n              onClick={() => {\n                dispatch(toggleVideo());\n              }}\n            >\n              {isVideoOn ? (\n                <VideocamOutlinedIcon />\n              ) : (\n                <VideocamOffOutlinedIcon />\n              )}\n            </IconButton>\n          </Tooltip>\n        </div>\n        {!isMobile && (\n          <div className={classes.right}>\n            {isUserCreator && (\n              <Tooltip title=\"invite users\">\n                <IconButton\n                  onClick={() => {\n                    setInviteModalOpen((o) => !o);\n                  }}\n                >\n                  <PersonAddIcon />\n                </IconButton>\n              </Tooltip>\n            )}\n            <Tooltip title=\"Meeting Details\">\n              <IconButton\n                onClick={() => {\n                  setDetailModalOpen((o) => !o);\n                }}\n              >\n                <InfoOutlinedIcon />\n              </IconButton>\n            </Tooltip>\n            <Tooltip title=\"Chat\">\n              <IconButton onClick={toggleChat}>\n                <MessageOutlinedIcon />\n              </IconButton>\n            </Tooltip>\n          </div>\n        )}\n        {isMobile && (\n          <div className={classes.right}>\n            <IconButton\n              aria-controls=\"simple-theme-menu\"\n              aria-haspopup=\"true\"\n              color=\"inherit\"\n              className=\"header-title-button\"\n              onClick={(event) => setAnchorEl(event.currentTarget)}\n            >\n              <MoreVertIcon />\n            </IconButton>\n            <Menu\n              anchorEl={anchorEl}\n              id={\"controls-menu\"}\n              keepMounted\n              open={isMenuOpen}\n              onClose={() => {\n                setAnchorEl(null);\n              }}\n            >\n              <MenuItem\n                onClick={() => {\n                  setAnchorEl(null);\n                  setInviteModalOpen((o) => !o);\n                }}\n              >\n                Invite User\n              </MenuItem>\n              <MenuItem\n                onClick={() => {\n                  setAnchorEl(null);\n                  setDetailModalOpen((o) => !o);\n                }}\n              >\n                Meeting Details\n              </MenuItem>\n              <MenuItem\n                onClick={() => {\n                  setAnchorEl(null);\n                  toggleChat();\n                }}\n              >\n                Chat\n              </MenuItem>\n            </Menu>\n          </div>\n        )}\n        {isUserCreator && (\n          <InviteModal open={inviteModalOpen} setOpen={setInviteModalOpen} />\n        )}\n        <DetailModal open={detailModalOpen} setOpen={setDetailModalOpen} />\n      </Grid>\n    </Paper>\n  );\n};\n\nexport default Controls;\n","export const split = (x) => {\n  let n = Math.floor(Math.sqrt(x));\n  let zp = n - (x % n);\n  let pp = Math.floor(x / n);\n  let m = [];\n  for (let i = 0; i < n; i++) {\n    if (i >= zp) {\n      m.push(pp + 1);\n    } else {\n      m.push(pp);\n    }\n  }\n  m = m.reverse();\n  let res = {};\n  let count = 1;\n  let idx = 0;\n  for (let i = 1; i <= x; i++) {\n    res[i] = m[idx];\n    count++;\n    if (count > m[idx]) {\n      count = 1;\n      idx++;\n    }\n  }\n  res[\"rows\"] = m.length;\n  return res;\n};\n\nexport function detectURL(message) {\n  var urlRegex = /(((https?:\\/\\/)|(www\\.))[^\\s]+)/g;\n  return message.replace(urlRegex, function (urlMatch) {\n    return `<a href=${urlMatch} target=\"_blank\" >${urlMatch}</a>`;\n  });\n}\nexport function sanitize(string) {\n  const map = {\n    \"&\": \"&amp;\",\n    \"<\": \"&lt;\",\n    \">\": \"&gt;\",\n    '\"': \"&quot;\",\n    \"'\": \"&#x27;\",\n    \"/\": \"&#x2F;\",\n  };\n  const reg = /[&<>\"'/]/gi;\n  return string.replace(reg, (match) => map[match]);\n}\n\nexport const getFullName = (firstName, lastName) => {\n  const fullName = firstName + \" \" + lastName;\n  return fullName.trim();\n};\n","import React, { useCallback, useEffect, useState } from \"react\";\nimport Drawer from \"@material-ui/core/Drawer\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport { IconButton } from \"@material-ui/core\";\nimport ChevronRightIcon from \"@material-ui/icons/ChevronRight\";\nimport WebSocketService from \"../../helper/WebsocketService\";\nimport TextField from \"@material-ui/core/TextField\";\nimport { Send } from \"@material-ui/icons\";\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\nimport { useSelector } from \"react-redux\";\nimport \"./chat.css\";\nconst drawerWidth = 360;\n\nconst useStyles = makeStyles((theme) => ({\n  drawer: {\n    width: drawerWidth,\n    flexShrink: 0,\n  },\n  drawerPaper: {\n    width: drawerWidth,\n    height: \"calc(100vh - 9rem)\",\n    borderRadius: \"1rem\",\n    top: \"5rem\",\n    right: \"12px\",\n  },\n  drawerHeader: {\n    display: \"flex\",\n    alignItems: \"center\",\n    padding: theme.spacing(0, 1),\n    ...theme.mixins.toolbar,\n    justifyContent: \"flex-start\",\n  },\n  chatInputContainer: {\n    marginTop: \"auto\",\n  },\n  chatInput: {\n    marginBottom: \"2rem\",\n    \"& .MuiFilledInput-root\": {\n      borderRadius: \"50px\",\n      borderBottom: 0,\n      paddingTop: \"15px\",\n      paddingBottom: \"15px\",\n      \"&::before\": { borderBottom: 0 },\n    },\n  },\n  messageBoxRight: {\n    background: theme.palette.background.paper,\n    color: theme.palette.text.primary,\n  },\n  messageBoxLeft: {\n    background: \"#4870df\",\n    color: theme.palette.background.default,\n  },\n  messageSender: {\n    color: theme.palette.text.primary,\n    fontSize: \"10px\",\n  },\n}));\n\nconst MessageItem = (props) => {\n  const owner = useSelector((state) => state.userReducer.user);\n  const classes = useStyles();\n  let messagePosition =\n    owner.pk === props.sender.id\n      ? `chatApp__convMessageItem--right`\n      : `chatApp__convMessageItem--left`;\n  let messageBackground =\n    owner.pk === props.sender.id\n      ? classes.messageBoxRight\n      : classes.messageBoxLeft;\n  return (\n    <div\n      className={\"chatApp__convMessageItem \" + messagePosition + \" clearfix\"}\n    >\n      <div className={`chatApp__convMessageValue ${messageBackground}`}>\n        {owner.pk !== props.sender.id && (\n          <div className={classes.messageSender}>{props.sender.first_name}</div>\n        )}\n        <div>{props.message}</div>\n      </div>\n    </div>\n  );\n};\n\nconst MessageList = React.memo((props) => {\n  return (\n    <div className={\"chatApp__convTimeline\"}>\n      {props.messages\n        .slice(0)\n        .reverse()\n        .map((messageItem, idx) => (\n          <MessageItem\n            key={idx}\n            sender={messageItem.sender}\n            senderAvatar={messageItem.senderAvatar}\n            message={messageItem.message}\n          />\n        ))}\n    </div>\n  );\n});\n\nconst Chat = ({ open, setOpen }) => {\n  const [messages, setMessages] = useState([]);\n  const [currMessage, setCurrMessage] = useState(\"\");\n  const classes = useStyles();\n  useEffect(() => {\n    WebSocketService.on(\"receive new message\", (data) => {\n      setMessages((messages) => [...messages, data]);\n    });\n  }, []);\n  const sendMessage = () => {\n    WebSocketService.sendMessage(\"send new message\", currMessage);\n    setCurrMessage(\"\");\n  };\n\n  const onCurrMessageChanged = useCallback((e) => {\n    const val = e.target.value;\n    setCurrMessage(val);\n  }, []);\n  return (\n    <Drawer\n      className={classes.drawer}\n      variant=\"persistent\"\n      anchor=\"right\"\n      open={open}\n      classes={{\n        paper: classes.drawerPaper,\n      }}\n    >\n      <div className={classes.drawerHeader}>\n        <IconButton\n          onClick={() => {\n            setOpen(false);\n          }}\n        >\n          <ChevronRightIcon />\n        </IconButton>\n      </div>\n      <MessageList messages={messages} />\n      <div className={classes.chatInputContainer}>\n        <TextField\n          placeholder=\"send a message to everyone\"\n          size=\"small\"\n          variant=\"filled\"\n          fullWidth\n          multiline\n          rowsMax={4}\n          className={classes.chatInput}\n          value={currMessage}\n          onChange={onCurrMessageChanged}\n          InputProps={{\n            endAdornment: (\n              <InputAdornment position=\"end\">\n                {currMessage.length > 0 && (\n                  <IconButton\n                    aria-label=\"toggle password visibility\"\n                    onClick={sendMessage}\n                  >\n                    <Send />\n                  </IconButton>\n                )}\n              </InputAdornment>\n            ),\n          }}\n        />\n      </div>\n    </Drawer>\n  );\n};\n\nexport default Chat;\n","import { toast } from \"react-toastify\";\nimport WebsocketService from \"./WebsocketService\";\nimport { getFullName } from \"../helper/utilFunctions\";\nimport { getUniqueArray } from \"./helperFunctions\";\nimport { addPeer, createPeer } from \"./peers\";\n\nexport const all_users_listener =\n  (peersRef, myID, stream, setPeers) => (users) => {\n    peersRef.current = {};\n    const temp = {};\n    users.forEach((user) => {\n      if (myID !== user.id) {\n        const peer = createPeer(user.id, myID, stream);\n\n        peersRef.current[user.id] = { user, peer };\n        temp[user.id] = {\n          user: user,\n          peer: peer,\n        };\n      }\n    });\n    setPeers(temp);\n  };\n\nexport const user_joined_listener =\n  (myID, peersRef, stream, setPeers, isUserAudioOn, isUserVideoOn) =>\n  (payload) => {\n    const user = payload.callerUser;\n    if (payload.usable_id === myID) {\n      const peer = addPeer(payload.signal, user.id, stream);\n      // if (!Boolean(peersRef.current[user.id])) {\n      peersRef.current[user.id] = { user, peer };\n      setPeers((peers) => ({\n        ...peers,\n        [user.id]: {\n          user: user,\n          peer: peer,\n        },\n      }));\n      // }\n      WebsocketService.sendMessage(\"audioMedia\", {\n        userID: myID,\n        audioOn: isUserAudioOn,\n      });\n      WebsocketService.sendMessage(\"videoMedia\", {\n        userID: myID,\n        videoOn: isUserVideoOn,\n      });\n      toast.info(`${getFullName(user.first_name, user.last_name)} joined`);\n    }\n  };\n\nexport const receive_returned_signal = (myID, peersRef) => (payload) => {\n  if (payload.usable_id === myID) {\n    const { peer } = peersRef.current[payload.id];\n    peer.signal(payload.signal);\n  }\n};\n\nexport const user_left_listener = (myID, peersRef, setPeers) => (payload) => {\n  const user = payload.user;\n  if (peersRef.current[user.id]) {\n    peersRef.current[user.id].peer.destroy();\n  }\n  delete peersRef.current[user.id];\n  setPeers((peers) => {\n    const { [payload.user.id]: remove, ...rest } = peers;\n    return rest;\n  });\n  if (payload.user.id !== myID) {\n    toast.info(`${getFullName(user.first_name, user.last_name)} left`);\n  }\n};\n\nexport const videoMediaListener = (peersRef, setPeers) => (payload) => {\n  const userID = payload.userID;\n  if (peersRef.current[userID]) {\n    peersRef.current[userID].user.videoOn = payload.videoOn;\n    setPeers((peers) => {\n      const { user, peer } = peers[userID];\n      return {\n        ...peers,\n        [userID]: { peer, user: { ...user, videoOn: payload.videoOn } },\n      };\n    });\n  }\n};\n\nexport const audioMediaListener = (peersRef, setPeers) => (payload) => {\n  const userID = payload.userID;\n  if (peersRef.current[userID]) {\n    peersRef.current[userID].user.audioOn = payload.audioOn;\n    setPeers((peers) => {\n      const { user, peer } = peers[userID];\n      return {\n        ...peers,\n        [userID]: { peer, user: { ...user, audioOn: payload.audioOn } },\n      };\n    });\n  }\n};\n\nexport const getPermissionListener = (myID, setAcceptStatus) => (payload) => {\n  if (payload.usable_id === myID) {\n    setAcceptStatus(payload.status);\n  }\n};\n\nexport const getPermissionRequestListener =\n  (myID, setWaitingUsers) => (payload) => {\n    if (payload.usable_id === myID) {\n      setWaitingUsers((users) => {\n        users.push(payload.user);\n        const newUsers = getUniqueArray(users, \"id\");\n        return newUsers;\n      });\n    }\n  };\n\nexport const userKickedListener = (myID, history) => (payload) => {\n  if (payload.usable_id === myID) {\n    history.replace(\"/\", {\n      message: \"The Organisor removed you from room\",\n      type: \"error\",\n    });\n  }\n};\n\nexport const userBlockedListener = (myID, history) => (payload) => {\n  if (payload.usable_id === myID) {\n    history.replace(\"/\", {\n      message: \"The Organisor blocked you from room\",\n      type: \"error\",\n    });\n  }\n};\n\nexport const joinMessageListener =\n  (setAcceptStatus, setServerMessage) => (message) => {\n    setAcceptStatus(\"message\");\n    if (message === \"creator not available\") {\n      setServerMessage(\n        \"The Organisor has not joined the room yet. Please try joining after some time\"\n      );\n    } else if (message === \"user blocked\") {\n      setServerMessage(\"The Organisor has blocked you.\");\n    }\n  };\n","import Peer from \"simple-peer\";\nimport WebsocketService from \"./WebsocketService\";\n\nexport function createPeer(userToSignal, callerID, stream) {\n  const peer = new Peer({\n    initiator: true,\n    trickle: false,\n    stream,\n    // iceTransportPolicy: \"relay\",\n    // reconnectTimer: 100,\n    // config: {\n    //   iceServers: [\n    //     {\n    //       urls: [\n    //         \"stun:stun.l.google.com:19302\",\n    //         \"stun:global.stun.twilio.com:3478\",\n    //       ],\n    //     },\n    //     {\n    //       urls: \"stun:numb.viagenie.ca\",\n    //       username: \"ayu023ban@gmail.com\",\n    //       credential: \"Manju2000@\",\n    //     },\n    //     {\n    //       urls: \"turn:numb.viagenie.ca\",\n    //       username: \"ayu023ban@gmail.com\",\n    //       credential: \"Manju2000@\",\n    //     },\n    //   ],\n    // },\n  });\n  peer.on(\"signal\", (signal) => {\n    WebsocketService.sendMessage(\"sending signal\", {\n      userToSignal,\n      callerID,\n      signal,\n    });\n  });\n  return peer;\n}\n\nexport function addPeer(incomingSignal, callerID, stream) {\n  const peer = new Peer({\n    initiator: false,\n    trickle: false,\n    stream,\n    // iceTransportPolicy: \"relay\",\n    // reconnectTimer: 100,\n    // config: {\n    //   iceServers: [\n    //     {\n    //       urls: [\n    //         \"stun:stun.l.google.com:19302\",\n    //         \"stun:global.stun.twilio.com:3478\",\n    //       ],\n    //     },\n    //     {\n    //       urls: \"stun:numb.viagenie.ca\",\n    //       username: \"ayu023ban@gmail.com\",\n    //       credential: \"Manju2000@\",\n    //     },\n    //     {\n    //       urls: \"turn:numb.viagenie.ca\",\n    //       username: \"ayu023ban@gmail.com\",\n    //       credential: \"Manju2000@\",\n    //     },\n    //   ],\n    // },\n  });\n  peer.on(\"signal\", (signal) => {\n    WebsocketService.sendMessage(\"returning signal\", { signal, callerID });\n  });\n  peer.signal(incomingSignal);\n  return peer;\n}\n","import { IconButton } from \"@material-ui/core\";\nimport React from \"react\";\nimport { Modal, Row, Col } from \"react-bootstrap\";\nimport CloseIcon from \"@material-ui/icons/Close\";\nimport CheckIcon from \"@material-ui/icons/Check\";\nimport { makeStyles } from \"@material-ui/styles\";\nimport WebSocketInstance from \"../../helper/WebsocketService\";\n\nconst useStyles = makeStyles((theme) => ({\n  modal: {\n    \"&& .modal-content\": {\n      background: theme.palette.background.paper,\n      color: theme.palette.text.primary,\n    },\n  },\n}));\n\nconst JoinModal = ({ waitingUsers, setWaitingUsers }) => {\n  const classes = useStyles();\n  const rejectUser = (user) => {\n    WebSocketInstance.sendMessage(\"give join permission status\", {\n      userID: user.id,\n      status: \"reject\",\n    });\n    setWaitingUsers((users) => users.filter((el) => el.id !== user.id));\n  };\n  const acceptUser = (user) => {\n    WebSocketInstance.sendMessage(\"give join permission status\", {\n      userID: user.id,\n      status: \"accept\",\n    });\n    setWaitingUsers((users) => users.filter((el) => el.id !== user.id));\n  };\n  return (\n    <Modal\n      show={Boolean(waitingUsers.length)}\n      onHide={() => {}}\n      backdrop=\"static\"\n      keyboard={false}\n      className={classes.modal}\n    >\n      <Modal.Header>\n        <Modal.Title>Modal title</Modal.Title>\n      </Modal.Header>\n      <Modal.Body>\n        {waitingUsers.map((user, idx) => (\n          <Row key={idx} style={{ alignItems: \"center\" }}>\n            <Col>{user.first_name} wants to join</Col>\n            <IconButton\n              onClick={() => {\n                rejectUser(user);\n              }}\n            >\n              <CloseIcon />\n            </IconButton>\n            <IconButton\n              onClick={() => {\n                acceptUser(user);\n              }}\n            >\n              <CheckIcon />\n            </IconButton>\n          </Row>\n        ))}\n      </Modal.Body>\n      <Modal.Footer></Modal.Footer>\n    </Modal>\n  );\n};\n\nexport default JoinModal;\n","export const updateStream = (peersRef, setPeers, userStream) => (stream) => {\n  for (let key in peersRef.current) {\n    // peersRef.current[key].removeTrack(\n    //   // userStream.getVideoTracks()[0],\n    //   peersRef.current[key].streams[0].getVideoTracks()[0],\n    //   userStream\n    // );\n    // peersRef.current[key].addTrack(stream.getVideoTracks()[0], userStream);\n    // peersRef.current[key]._pc.getSenders().forEach((sender) => {\n    //   if (sender.track.type === \"video\") {\n    //     sender.replaceTrack(userStream.getVideoTracks()[0]);\n    //   }\n    // });\n    peersRef.current[key].peer.streams.forEach((stream) => {\n      stream.getTracks().forEach((track) => {\n        track.stop();\n      });\n    });\n  }\n  setPeers({ ...peersRef.current });\n  userStream.removeTrack(userStream.getVideoTracks()[0]);\n  userStream.addTrack(stream.getVideoTracks()[0]);\n};\n\nexport const switchCamera = (videoConstraints) => async (currentCameraRef) => {\n  const devices = await navigator.mediaDevices.enumerateDevices();\n  const videoDevices = devices.filter((device) => device.kind === \"videoinput\");\n  currentCameraRef.current =\n    (currentCameraRef.current + 1) % videoDevices.length;\n\n  const updatedConstraints = {\n    ...videoConstraints,\n    deviceId: {\n      exact: videoDevices[currentCameraRef.current].deviceId,\n    },\n  };\n  videoConstraints = updatedConstraints;\n\n  const stream = await navigator.mediaDevices.getUserMedia({\n    video: videoConstraints,\n    audio: true,\n  });\n  updateStream(stream);\n};\n\nexport const shareScreen = (peersRef, userStream) => () => {\n  navigator.mediaDevices\n    .getDisplayMedia({ cursor: true })\n    .then((screenStream) => {\n      // const temp = {};\n      Object.keys(peersRef.current).forEach((key) => {\n        // let peer = peersRef.current[key];\n        peersRef.current[key].replaceTrack(\n          userStream.getVideoTracks()[0],\n          screenStream.getVideoTracks()[0],\n          userStream\n        );\n        // temp[key] = peer;\n      });\n    });\n};\n","import React, { useEffect, useRef, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport WebsocketService from \"../helper/WebsocketService\";\nimport { useParams } from \"react-router\";\nimport Video from \"../components/common/Video\";\nimport Controls from \"../components/Room/Controls\";\nimport { split } from \"../helper/utilFunctions\";\nimport Chat from \"../components/Room/Chat\";\nimport { makeStyles } from \"@material-ui/core\";\nimport {\n  all_users_listener,\n  user_joined_listener,\n  user_left_listener,\n  receive_returned_signal,\n  videoMediaListener,\n  audioMediaListener,\n  getPermissionRequestListener,\n} from \"../helper/socketListeners\";\nimport JoinModal from \"../components/Room/JoinModal\";\nimport { switchCamera } from \"../helper/unusedFunctions\";\nimport { getIsUserCreator, getRoom } from \"../redux/actions/roomActions\";\n\nlet videoConstraints = {\n  height: window.innerHeight / 2,\n  width: window.innerWidth / 2,\n};\n\nconst useStyles = makeStyles((theme) => ({\n  container: {\n    display: \"flex\",\n    height: \"100%\",\n    width: \"100%\",\n    flexDirection: \"column\",\n    background: theme.palette.background.default,\n  },\n}));\n\nconst socketFunctions = (\n  peersRef,\n  myID,\n  stream,\n  setPeers,\n  isUserAudioOn,\n  isUserVideoOn,\n  setWaitingUsers\n) => {\n  WebsocketService.on(\n    \"all users\",\n    all_users_listener(peersRef, myID, stream, setPeers)\n  );\n  WebsocketService.on(\n    \"user joined\",\n    user_joined_listener(\n      myID,\n      peersRef,\n      stream,\n      setPeers,\n      isUserAudioOn,\n      isUserVideoOn\n    )\n  );\n\n  WebsocketService.on(\n    \"receiving returned signal\",\n    receive_returned_signal(myID, peersRef)\n  );\n\n  WebsocketService.on(\n    \"user left\",\n    user_left_listener(myID, peersRef, setPeers)\n  );\n\n  WebsocketService.on(\"videoMedia\", videoMediaListener(peersRef, setPeers));\n\n  WebsocketService.on(\"audioMedia\", audioMediaListener(peersRef, setPeers));\n  WebsocketService.on(\n    \"user want to join\",\n    getPermissionRequestListener(myID, setWaitingUsers)\n  );\n};\n\nconst Room = () => {\n  const { roomID } = useParams();\n  const [peers, setPeers] = useState({});\n  const userVideo = useRef();\n  const socketRef = useRef(WebsocketService);\n  const peersRef = useRef({});\n  const myID = useSelector((state) => state.userReducer.user.pk);\n  const [userStream, setUserStream] = useState();\n  const currentCameraRef = useRef(0);\n  let sizeMap = split(Object.keys(peers).length + 1);\n  const [chatOpen, setChatOpen] = useState(false);\n  const isUserAudioOn = useSelector(\n    (state) => state.roomReducer.userVideo.audioOn\n  );\n  const isUserVideoOn = useSelector(\n    (state) => state.roomReducer.userVideo.videoOn\n  );\n  const classes = useStyles();\n  const me = useSelector((state) => state.userReducer.user);\n  const [waitingUsers, setWaitingUsers] = useState([]);\n  const dispatch = useDispatch();\n\n  const setCameraStream = async () => {\n    const stream = await navigator.mediaDevices.getUserMedia({\n      video: true,\n      audio: true,\n    });\n    setUserStream(stream);\n    if (userVideo && userVideo.current) {\n      userVideo.current.srcObject = stream;\n    }\n  };\n\n  const socketConnect = async () => {\n    await setCameraStream();\n    socketRef.current.sendMessage(\"join room\", roomID);\n  };\n\n  useEffect(() => {\n    dispatch(getIsUserCreator(roomID));\n    dispatch(getRoom(roomID));\n    socketConnect();\n  }, []);\n\n  useEffect(() => {\n    socketFunctions(\n      peersRef,\n      myID,\n      userStream,\n      setPeers,\n      isUserAudioOn,\n      isUserVideoOn,\n      setWaitingUsers\n    );\n  }, [userStream, isUserAudioOn, isUserVideoOn, myID]);\n\n  useEffect(() => {\n    let userStreamRef = userStream;\n    return () => {\n      if (userStreamRef) {\n        userStreamRef.getVideoTracks().forEach((track) => {\n          track.stop();\n        });\n        userStreamRef.getAudioTracks().forEach((track) => {\n          track.stop();\n        });\n      }\n    };\n  }, [userStream]);\n\n  useEffect(() => {\n    if (userStream) {\n      userStream.getAudioTracks()[0].enabled = isUserAudioOn;\n      if (socketRef.current.state() === 1) {\n        socketRef.current.sendMessage(\"audioMedia\", {\n          userID: myID,\n          audioOn: isUserAudioOn,\n        });\n      }\n    }\n  }, [userStream, isUserAudioOn, myID]);\n\n  useEffect(() => {\n    if (userStream) {\n      userStream.getVideoTracks()[0].enabled = isUserVideoOn;\n      if (socketRef.current.state() === 1) {\n        socketRef.current.sendMessage(\"videoMedia\", {\n          userID: myID,\n          videoOn: isUserVideoOn,\n        });\n      }\n    }\n  }, [userStream, isUserVideoOn, myID]);\n\n  useEffect(() => {\n    sizeMap = split(Object.keys(peers).length + 1);\n  }, [peers]);\n\n  return (\n    <div className={classes.container}>\n      <div\n        style={{\n          display: \"flex\",\n          width: \"100%\",\n          maxHeight: \"calc(100vh - 7rem)\",\n          margin: \"auto\",\n          flexGrow: \"1\",\n          flexWrap: \"wrap\",\n        }}\n      >\n        <Video\n          muted\n          ref={userVideo}\n          user={{ ...me, videoOn: isUserVideoOn, audioOn: isUserAudioOn }}\n          autoPlay\n          playsInline\n          size={sizeMap[1]}\n          rows={sizeMap[\"rows\"]}\n          isUserVideo\n        />\n        {Object.values(peersRef.current).map((item, index) => {\n          return (\n            <Video\n              key={index}\n              peer={item.peer}\n              user={item.user}\n              size={sizeMap[index + 2]}\n              rows={sizeMap[\"rows\"]}\n            />\n          );\n        })}\n      </div>\n      <JoinModal\n        waitingUsers={waitingUsers}\n        setWaitingUsers={setWaitingUsers}\n      />\n      <Controls\n        switchc={() => {\n          switchCamera(videoConstraints)(currentCameraRef);\n        }}\n        toggleChat={() => {\n          setChatOpen((open) => !open);\n        }}\n      />\n      <Chat open={chatOpen} setOpen={setChatOpen} />\n    </div>\n  );\n};\n\nexport default Room;\n","import React, { useEffect, useState } from \"react\";\nimport WebSocketInstance from \"../helper/WebsocketService\";\nimport { useHistory, useParams } from \"react-router\";\nimport Room from \"./RoomView\";\nimport {\n  getPermissionListener,\n  joinMessageListener,\n  userBlockedListener,\n  userKickedListener,\n} from \"../helper/socketListeners\";\nimport { useSelector } from \"react-redux\";\nimport Typography from \"@material-ui/core/Typography\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport { makeStyles } from \"@material-ui/styles\";\nimport { Paper } from \"@material-ui/core\";\nconst useStyles = makeStyles((theme) => ({\n  container: {\n    background: theme.palette.background.default,\n    height: \"100%\",\n    width: \"100%\",\n    position: \"relative\",\n  },\n  color: { color: theme.palette.text.primary },\n  paper: {\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    maxWidth: \"75vw\",\n    position: \"relative\",\n    marginLeft: \"auto\",\n    marginRight: \"auto\",\n    top: \"3rem\",\n  },\n}));\n\nconst View = () => {\n  const { roomID } = useParams();\n  const history = useHistory();\n  const classes = useStyles();\n  const myID = useSelector((state) => state.userReducer.user.pk);\n  const [acceptStatus, setAcceptStatus] = useState(\"pending\");\n  const [serverMessage, setServerMessage] = useState(\"\");\n  useEffect(() => {\n    WebSocketInstance.refresh();\n    let protocol = window.location.protocol === \"http:\" ? \"ws\" : \"wss\";\n    let host = window.location.hostname.includes(\"localhost\")\n      ? \"localhost:7000\"\n      : window.location.hostname;\n    WebSocketInstance.connect(\n      `${protocol}://${host}/ws/room/${roomID}/`,\n      (e) => {\n        history.replace(\"/\", {\n          message: \"the url entered is incorrect.\",\n          type: \"error\",\n        });\n      }\n    );\n    WebSocketInstance.on(\n      \"get permission\",\n      getPermissionListener(myID, setAcceptStatus)\n    );\n    WebSocketInstance.on(\n      \"join message\",\n      joinMessageListener(setAcceptStatus, setServerMessage)\n    );\n    WebSocketInstance.on(\"user kicked\", userKickedListener(myID, history));\n    WebSocketInstance.on(\"user blocked\", userBlockedListener(myID, history));\n    return () => {\n      WebSocketInstance.close();\n    };\n  }, []);\n\n  useEffect(() => {\n    if (acceptStatus === \"reject\") {\n      history.replace(\"/\", {\n        message: \"The creator rejected the join request\",\n        type: \"error\",\n      });\n    }\n  }, [acceptStatus]);\n\n  return (\n    <>\n      {acceptStatus === \"pending\" ? (\n        <div className={classes.container}>\n          <Paper elevation={3} variant=\"outlined\" className={classes.paper}>\n            <Typography\n              variant=\"h2\"\n              className={classes.color}\n              style={{ width: \"max-content\" }}\n            >\n              Joining the room\n            </Typography>\n            <CircularProgress\n              className={classes.color}\n              style={{ marginLeft: \"1rem\" }}\n            />\n          </Paper>\n        </div>\n      ) : acceptStatus === \"accept\" ? (\n        <Room />\n      ) : acceptStatus === \"message\" ? (\n        <div className={classes.container}>\n          <Paper elevation={3} variant=\"outlined\" className={classes.paper}>\n            <Typography\n              variant=\"h2\"\n              className={classes.color}\n              style={{ width: \"max-content\" }}\n              align=\"center\"\n            >\n              {serverMessage}\n            </Typography>\n          </Paper>\n        </div>\n      ) : null}\n    </>\n  );\n};\n\nexport default View;\n"],"sourceRoot":""}